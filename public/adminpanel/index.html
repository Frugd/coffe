<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Brew & Bean ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
  <style>
/* ===== THEME VARIABLES ===== */
:root[data-theme="dark"] {
  --sidebar-bg: #1c1917;
  --sidebar-border: rgba(255,255,255,.08);
  --sidebar-text: #a8a29e;
  --sidebar-hover-bg: rgba(255,255,255,.05);
  --sidebar-active-bg: #92400e;
  --sidebar-active-shadow: rgba(146,64,14,.3);
  --sidebar-logo-icon-bg: #92400e;
  --sidebar-sub: #666;

  --main-bg: #f5f5f4;
  --card-bg: #fff;
  --card-border: #f0eeeb;
  --card-hover-shadow: rgba(0,0,0,.06);
  --text-primary: #1a1a1a;
  --text-secondary: #888;
  --text-muted: #aaa;
  --text-accent: #92400e;
  --accent: #92400e;
  --accent-hover: #78350f;
  --accent-light: #fffbeb;

  --input-bg: #fafaf9;
  --input-border: #e5e2de;
  --input-focus-border: #d97706;
  --table-header-bg: #fafaf9;
  --table-row-hover: #fafaf9;
  --table-border: #f5f5f4;

  --mobile-header-bg: #fff;
  --mobile-header-border: #e5e2de;

  --modal-overlay: rgba(0,0,0,.4);
  --modal-bg: #fff;

  --scrollbar-thumb: #d6d3d1;

  --success: #16a34a;
  --success-bg: #f0fdf4;
  --warning: #d97706;
  --warning-bg: #fffbeb;
  --danger: #ef4444;
  --danger-bg: #fef2f2;
  --info: #2563eb;
  --info-bg: #eff6ff;
  --purple: #9333ea;
  --purple-bg: #faf5ff;

  --theme-toggle-bg: #292524;
  --theme-toggle-dot: #fbbf24;
  --theme-icon: "üåô";
}

:root[data-theme="light"] {
  --sidebar-bg: linear-gradient(180deg, #1e40af 0%, #1e3a8a 50%, #172554 100%);
  --sidebar-border: rgba(255,255,255,.12);
  --sidebar-text: rgba(255,255,255,.65);
  --sidebar-hover-bg: rgba(255,255,255,.08);
  --sidebar-active-bg: rgba(255,255,255,.15);
  --sidebar-active-shadow: rgba(255,255,255,.1);
  --sidebar-logo-icon-bg: #3b82f6;
  --sidebar-sub: rgba(255,255,255,.35);

  --main-bg: #f0f4ff;
  --card-bg: #fff;
  --card-border: #e0e7ff;
  --card-hover-shadow: rgba(59,130,246,.08);
  --text-primary: #1e293b;
  --text-secondary: #64748b;
  --text-muted: #94a3b8;
  --text-accent: #1d4ed8;
  --accent: #2563eb;
  --accent-hover: #1d4ed8;
  --accent-light: #eff6ff;

  --input-bg: #f8fafc;
  --input-border: #cbd5e1;
  --input-focus-border: #3b82f6;
  --table-header-bg: #f8fafc;
  --table-row-hover: #f1f5f9;
  --table-border: #e2e8f0;

  --mobile-header-bg: #fff;
  --mobile-header-border: #e0e7ff;

  --modal-overlay: rgba(15,23,42,.4);
  --modal-bg: #fff;

  --scrollbar-thumb: #94a3b8;

  --success: #059669;
  --success-bg: #ecfdf5;
  --warning: #d97706;
  --warning-bg: #fffbeb;
  --danger: #dc2626;
  --danger-bg: #fef2f2;
  --info: #2563eb;
  --info-bg: #eff6ff;
  --purple: #7c3aed;
  --purple-bg: #f5f3ff;

  --theme-toggle-bg: #dbeafe;
  --theme-toggle-dot: #2563eb;
  --theme-icon: "‚òÄÔ∏è";
}

/* ===== RESET ===== */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;color:var(--text-primary);background:var(--main-bg);line-height:1.6;-webkit-font-smoothing:antialiased;transition:background .3s,color .3s}
a{text-decoration:none;color:inherit}
button{cursor:pointer;border:none;background:none;font:inherit}
input,textarea,select{font:inherit}
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--scrollbar-thumb);border-radius:10px}

/* ===== LAYOUT ===== */
.app{display:flex;min-height:100vh}

/* ===== THEME TOGGLE ===== */
.theme-toggle-wrap{padding:12px 20px;border-top:1px solid var(--sidebar-border)}
.theme-toggle-row{display:flex;align-items:center;gap:10px;font-size:13px;color:var(--sidebar-text)}
.theme-toggle-row span{flex:1}
.theme-toggle{position:relative;width:52px;height:28px;border-radius:50px;background:var(--theme-toggle-bg);cursor:pointer;transition:background .3s;border:none;padding:0;flex-shrink:0}
.theme-toggle::before{content:"";position:absolute;top:3px;left:3px;width:22px;height:22px;border-radius:50%;background:var(--theme-toggle-dot);transition:transform .3s,background .3s;box-shadow:0 2px 4px rgba(0,0,0,.2)}
[data-theme="light"] .theme-toggle::before{transform:translateX(24px)}
.theme-toggle::after{content:var(--theme-icon);position:absolute;top:50%;transform:translateY(-50%);font-size:14px}
[data-theme="dark"] .theme-toggle::after{right:6px}
[data-theme="light"] .theme-toggle::after{left:6px}
.theme-labels{display:flex;justify-content:space-between;font-size:10px;color:var(--sidebar-text);margin-top:4px;padding:0 4px;opacity:.6}

/* ===== SIDEBAR ===== */
.sidebar{width:260px;background:var(--sidebar-bg);color:#fff;display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:50;transition:transform .3s}
.sidebar-header{padding:20px 24px;border-bottom:1px solid var(--sidebar-border)}
.sidebar-logo{display:flex;align-items:center;gap:10px;font-size:18px;font-weight:800}
.sidebar-logo .icon{width:36px;height:36px;border-radius:10px;background:var(--sidebar-logo-icon-bg);display:flex;align-items:center;justify-content:center;font-size:16px;transition:background .3s}
.sidebar-logo em{font-style:normal;color:#fbbf24}
[data-theme="light"] .sidebar-logo em{color:#60a5fa}
.sidebar-sub{font-size:11px;color:var(--sidebar-sub);margin-top:4px}
.sidebar-nav{flex:1;padding:16px 12px;overflow-y:auto}
.nav-section{font-size:10px;text-transform:uppercase;letter-spacing:1.5px;color:rgba(255,255,255,.25);padding:12px 12px 8px;font-weight:600}
.nav-item{display:flex;align-items:center;gap:12px;padding:10px 16px;border-radius:10px;font-size:14px;font-weight:500;color:var(--sidebar-text);transition:all .2s;margin-bottom:2px;cursor:pointer}
.nav-item:hover{background:var(--sidebar-hover-bg);color:#fff}
.nav-item.active{background:var(--sidebar-active-bg);color:#fff;box-shadow:0 4px 16px var(--sidebar-active-shadow)}
[data-theme="light"] .nav-item.active{backdrop-filter:blur(10px)}
.nav-item .emoji{font-size:18px;width:24px;text-align:center}
.nav-item .badge{margin-left:auto;padding:2px 8px;border-radius:50px;font-size:10px;font-weight:700;background:rgba(239,68,68,.2);color:#ef4444}
[data-theme="light"] .nav-item .badge{background:rgba(255,255,255,.2);color:#fbbf24}
.sidebar-footer{padding:16px 20px;border-top:1px solid var(--sidebar-border)}
.sidebar-footer a{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--sidebar-text);transition:color .2s;padding:8px 0}
.sidebar-footer a:hover{color:#fbbf24}

/* ===== MOBILE ===== */
.sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:40}
.sidebar-overlay.show{display:block}
.mobile-header{display:none;position:fixed;top:0;left:0;right:0;z-index:30;background:var(--mobile-header-bg);padding:12px 16px;border-bottom:1px solid var(--mobile-header-border);align-items:center;gap:12px;transition:background .3s}
.mobile-header .burger{width:40px;height:40px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:20px;color:var(--text-secondary)}
.mobile-header .title{font-size:16px;font-weight:700;color:var(--text-primary)}
@media(max-width:768px){
  .sidebar{transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .mobile-header{display:flex}
  .main{margin-left:0!important;padding-top:72px!important}
  .dash-grid-2{grid-template-columns:1fr!important}
}

/* ===== MAIN ===== */
.main{flex:1;margin-left:260px;padding:32px;transition:background .3s}
.page{display:none}
.page.active{display:block}
.page-header{margin-bottom:32px}
.page-header h1{font-size:28px;font-weight:800;margin-bottom:4px;color:var(--text-primary)}
.page-header p{font-size:14px;color:var(--text-secondary)}
.page-actions{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}

/* ===== CARDS ===== */
.stats-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;margin-bottom:32px}
.stat-card{padding:24px;border-radius:14px;background:var(--card-bg);border:1px solid var(--card-border);transition:all .3s}
.stat-card:hover{box-shadow:0 8px 24px var(--card-hover-shadow);transform:translateY(-2px)}
.stat-card .top{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.stat-card .icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px}
.stat-card .icon.amber{background:var(--warning-bg)}
.stat-card .icon.green{background:var(--success-bg)}
.stat-card .icon.blue{background:var(--info-bg)}
.stat-card .icon.red{background:var(--danger-bg)}
.stat-card .icon.purple{background:var(--purple-bg)}
.stat-card .change{font-size:11px;font-weight:600;padding:3px 10px;border-radius:50px}
.stat-card .change.up{background:var(--success-bg);color:var(--success)}
.stat-card .change.down{background:var(--danger-bg);color:var(--danger)}
.stat-card h3{font-size:28px;font-weight:800;color:var(--text-primary)}
.stat-card .label{font-size:12px;color:var(--text-secondary);margin-top:4px}

/* ===== TABLE ===== */
.table-wrap{background:var(--card-bg);border-radius:14px;border:1px solid var(--card-border);overflow:hidden;transition:all .3s}
.table-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--card-border);flex-wrap:wrap;gap:12px}
.table-header h3{font-size:16px;font-weight:700;color:var(--text-primary)}
.table-header .tools{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.search-input{padding:8px 14px;border-radius:8px;border:1px solid var(--input-border);background:var(--input-bg);font-size:13px;outline:none;width:220px;transition:all .2s;color:var(--text-primary)}
.search-input:focus{border-color:var(--input-focus-border)}
.table-scroll{overflow-x:auto}
table{width:100%;border-collapse:collapse;min-width:600px}
thead{background:var(--table-header-bg)}
th{padding:12px 16px;font-size:11px;font-weight:700;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px;text-align:left;border-bottom:1px solid var(--card-border);white-space:nowrap}
td{padding:12px 16px;font-size:13px;border-bottom:1px solid var(--table-border);vertical-align:middle;color:var(--text-primary)}
tr:hover td{background:var(--table-row-hover)}
.table-empty{padding:40px;text-align:center;color:var(--text-muted);font-size:14px}

/* ===== STATUS ===== */
.status{display:inline-block;padding:3px 12px;border-radius:50px;font-size:11px;font-weight:600}
.status.green{background:var(--success-bg);color:var(--success)}
.status.yellow{background:var(--warning-bg);color:var(--warning)}
.status.red{background:var(--danger-bg);color:var(--danger)}
.status.blue{background:var(--info-bg);color:var(--info)}
.status.gray{background:var(--table-header-bg);color:var(--text-secondary)}
.status.purple{background:var(--purple-bg);color:var(--purple)}

/* ===== BUTTONS ===== */
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 18px;border-radius:8px;font-size:13px;font-weight:600;transition:all .2s;white-space:nowrap;cursor:pointer;border:none}
.btn-primary{background:var(--accent);color:#fff}
.btn-primary:hover{background:var(--accent-hover)}
.btn-success{background:var(--success);color:#fff}
.btn-success:hover{opacity:.9}
.btn-danger{background:var(--danger);color:#fff}
.btn-danger:hover{opacity:.9}
.btn-outline{background:var(--card-bg);color:var(--text-secondary);border:1px solid var(--input-border)}
.btn-outline:hover{border-color:var(--accent);color:var(--accent)}
.btn-sm{padding:5px 12px;font-size:11px;border-radius:6px}
.btn-icon{width:32px;height:32px;padding:0;display:flex;align-items:center;justify-content:center;border-radius:8px;font-size:14px;background:var(--card-bg);border:1px solid var(--input-border);color:var(--text-secondary);transition:all .2s}
.btn-icon:hover{border-color:var(--accent);color:var(--accent)}
.btn-icon.danger:hover{border-color:var(--danger);color:var(--danger)}
.actions-cell{display:flex;gap:6px}

/* ===== MODAL ===== */
.modal-overlay{display:none;position:fixed;inset:0;background:var(--modal-overlay);z-index:100;align-items:center;justify-content:center;padding:24px}
.modal-overlay.open{display:flex}
.modal{background:var(--modal-bg);border-radius:16px;width:100%;max-width:560px;max-height:calc(100vh - 48px);overflow-y:auto;box-shadow:0 24px 64px rgba(0,0,0,.15)}
.modal-head{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid var(--card-border)}
.modal-head h3{font-size:18px;font-weight:700;color:var(--text-primary)}
.modal-close{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px;color:var(--text-secondary);transition:all .2s}
.modal-close:hover{background:var(--table-header-bg);color:var(--text-primary)}
.modal-body{padding:24px}
.modal-footer{display:flex;gap:12px;justify-content:flex-end;padding:16px 24px;border-top:1px solid var(--card-border)}

/* ===== FORMS ===== */
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:12px;font-weight:600;color:var(--text-secondary);margin-bottom:6px}
.form-group input,.form-group select,.form-group textarea{width:100%;padding:10px 14px;border-radius:8px;border:1px solid var(--input-border);background:var(--input-bg);font-size:13px;outline:none;transition:all .2s;color:var(--text-primary)}
.form-group input:focus,.form-group select:focus,.form-group textarea:focus{border-color:var(--input-focus-border);background:var(--card-bg)}
.form-group textarea{resize:vertical;min-height:60px}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:480px){.form-row{grid-template-columns:1fr}}

/* ===== TABS ===== */
.tabs{display:flex;gap:4px;margin-bottom:24px;border-bottom:2px solid var(--card-border);padding-bottom:0}
.tab{padding:10px 20px;font-size:13px;font-weight:600;color:var(--text-secondary);border-bottom:2px solid transparent;margin-bottom:-2px;transition:all .2s;cursor:pointer;background:none;border-top:none;border-left:none;border-right:none}
.tab:hover{color:var(--accent)}
.tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.tab-content{display:none}
.tab-content.active{display:block}

/* ===== CONFIG ===== */
.config-panel{background:var(--card-bg);border-radius:14px;border:1px solid var(--card-border);padding:24px;margin-bottom:24px;transition:all .3s}
.config-panel h3{font-size:16px;font-weight:700;margin-bottom:16px;color:var(--text-primary)}
.config-row{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--table-border)}
.config-row:last-child{border-bottom:none}
.config-row label{font-size:13px;font-weight:600;min-width:120px;color:var(--text-primary)}
.config-row input,.config-row select{flex:1;padding:8px 12px;border-radius:8px;border:1px solid var(--input-border);font-size:13px;outline:none;background:var(--input-bg);color:var(--text-primary)}
.config-row input:focus{border-color:var(--input-focus-border)}

/* ===== TIMELINE ===== */
.timeline{display:flex;gap:4px;align-items:center}
.timeline-step{display:flex;align-items:center;gap:4px}
.timeline-dot{width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px;border:2px solid var(--input-border);color:var(--text-muted);background:var(--card-bg)}
.timeline-dot.done{border-color:var(--success);background:var(--success);color:#fff}
.timeline-dot.current{border-color:var(--warning);background:var(--warning-bg);color:var(--warning)}
.timeline-line{width:16px;height:2px;background:var(--input-border)}
.timeline-line.done{background:var(--success)}

/* ===== MISC ===== */
.text-right{text-align:right}
.text-center{text-align:center}
.text-muted{color:var(--text-muted)}
.text-bold{font-weight:700}
.text-accent{color:var(--text-accent)}
.mt-16{margin-top:16px}
.mt-24{margin-top:24px}
.mb-16{margin-bottom:16px}
.mb-24{margin-bottom:24px}
.dash-grid-2{display:grid;grid-template-columns:1fr 1fr;gap:24px}

/* ===== TOAST ===== */
.toast{position:fixed;top:20px;right:20px;z-index:200;padding:14px 24px;border-radius:10px;font-size:13px;font-weight:600;color:#fff;box-shadow:0 8px 30px rgba(0,0,0,.15);transform:translateX(120%);transition:transform .3s;display:flex;align-items:center;gap:8px}
.toast.show{transform:translateX(0)}
.toast.success{background:var(--success)}
.toast.error{background:var(--danger)}
.toast.info{background:var(--info)}

/* ===== THEME PREVIEW CARDS ===== */
.theme-cards{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:24px}
.theme-card{border-radius:14px;padding:24px;cursor:pointer;transition:all .3s;border:3px solid transparent;position:relative;overflow:hidden}
.theme-card:hover{transform:translateY(-2px)}
.theme-card.active{border-color:var(--accent);box-shadow:0 8px 32px var(--card-hover-shadow)}
.theme-card.active::after{content:"‚úì –ê–∫—Ç–∏–≤–Ω–∞";position:absolute;top:12px;right:12px;background:var(--accent);color:#fff;padding:3px 12px;border-radius:50px;font-size:11px;font-weight:700}
.theme-card-dark{background:#1c1917;color:#fff}
.theme-card-dark .tc-sidebar{background:#292524;border-radius:8px;padding:12px;margin-bottom:12px}
.theme-card-dark .tc-dot{display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:4px}
.theme-card-dark .tc-dot-1{background:#92400e}
.theme-card-dark .tc-dot-2{background:#44403c}
.theme-card-dark .tc-dot-3{background:#44403c}
.theme-card-dark .tc-bar{height:6px;border-radius:3px;background:#44403c;margin:4px 0}
.theme-card-dark .tc-bar.accent{background:#92400e;width:60%}
.theme-card-dark .tc-content{display:flex;gap:8px}
.theme-card-dark .tc-card{background:#292524;border-radius:6px;padding:10px;flex:1}
.theme-card-dark .tc-card-bar{height:4px;border-radius:2px;background:#44403c;margin-top:6px}
.theme-card-dark h4{font-size:15px;font-weight:700;margin-bottom:4px}
.theme-card-dark p{font-size:11px;color:#a8a29e}

.theme-card-light{background:linear-gradient(135deg,#eff6ff,#dbeafe);color:#1e293b}
.theme-card-light .tc-sidebar{background:linear-gradient(180deg,#1e40af,#1e3a8a);border-radius:8px;padding:12px;margin-bottom:12px}
.theme-card-light .tc-dot{display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:4px}
.theme-card-light .tc-dot-1{background:#3b82f6}
.theme-card-light .tc-dot-2{background:rgba(255,255,255,.2)}
.theme-card-light .tc-dot-3{background:rgba(255,255,255,.2)}
.theme-card-light .tc-bar{height:6px;border-radius:3px;background:rgba(255,255,255,.15);margin:4px 0}
.theme-card-light .tc-bar.accent{background:rgba(255,255,255,.3);width:60%}
.theme-card-light .tc-content{display:flex;gap:8px}
.theme-card-light .tc-card{background:#fff;border-radius:6px;padding:10px;flex:1;border:1px solid #e0e7ff}
.theme-card-light .tc-card-bar{height:4px;border-radius:2px;background:#e0e7ff;margin-top:6px}
.theme-card-light h4{font-size:15px;font-weight:700;margin-bottom:4px}
.theme-card-light p{font-size:11px;color:#64748b}

@media(max-width:600px){.theme-cards{grid-template-columns:1fr}}

/* ===== PRINT ===== */
@media print{
  .sidebar,.mobile-header,.page-actions,.btn,.modal-overlay,.toast,.sidebar-overlay,.theme-toggle-wrap{display:none!important}
  .main{margin-left:0!important;padding:16px!important}
  .table-wrap{border:1px solid #ccc}
}
  </style>
</head>
<body>

<div class="toast" id="toast"></div>

<div class="mobile-header">
  <button class="burger" id="burgerBtn">‚ò∞</button>
  <span class="title">‚òï –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</span>
</div>
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<div class="app">

<!-- ===== SIDEBAR ===== -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div class="sidebar-logo">
      <div class="icon">‚òï</div>
      Brew <em>&</em> Bean
    </div>
    <div class="sidebar-sub">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
  </div>
  <nav class="sidebar-nav">
    <div class="nav-section">–û—Å–Ω–æ–≤–Ω–æ–µ</div>
    <div class="nav-item active" data-page="dashboard"><span class="emoji">üìä</span> –î–∞—à–±–æ—Ä–¥</div>
    <div class="nav-item" data-page="products"><span class="emoji">üì¶</span> –¢–æ–≤–∞—Ä—ã</div>
    <div class="nav-item" data-page="sales"><span class="emoji">üí∞</span> –ü—Ä–æ–¥–∞–∂–∏</div>
    <div class="nav-item" data-page="delivery"><span class="emoji">üöó</span> –î–æ—Å—Ç–∞–≤–∫–∞ <span class="badge" id="deliveryBadge"></span></div>
    <div class="nav-section">–°–∏—Å—Ç–µ–º–∞</div>
    <div class="nav-item" data-page="appearance"><span class="emoji">üé®</span> –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</div>
    <div class="nav-item" data-page="settings"><span class="emoji">‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI</div>
  </nav>
  <div class="theme-toggle-wrap">
    <div class="theme-toggle-row">
      <span>–¢–µ–º–∞</span>
      <button class="theme-toggle" id="themeToggle" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É"></button>
    </div>
    <div class="theme-labels"><span>–¢—ë–º–Ω–∞—è</span><span>–°–≤–µ—Ç–ª–∞—è</span></div>
  </div>
  <div class="sidebar-footer">
    <a href="../">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç</a>
  </div>
</aside>

<!-- ===== MAIN ===== -->
<main class="main">

<!-- DASHBOARD -->
<div class="page active" id="page-dashboard">
  <div class="page-header">
    <h1>üìä –î–∞—à–±–æ—Ä–¥</h1>
    <p>–û–±–∑–æ—Ä –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∫–æ—Ñ–µ–π–Ω–∏</p>
  </div>
  <div class="stats-grid" id="dashStats"></div>
  <div class="dash-grid-2">
    <div class="table-wrap">
      <div class="table-header"><h3>üî• –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏</h3></div>
      <div class="table-scroll">
        <table><thead><tr><th>–¢–æ–≤–∞—Ä</th><th>–ö–æ–ª-–≤–æ</th><th>–°—É–º–º–∞</th><th>–î–∞—Ç–∞</th></tr></thead>
        <tbody id="dashSalesBody"></tbody></table>
      </div>
    </div>
    <div class="table-wrap">
      <div class="table-header"><h3>üöó –ê–∫—Ç–∏–≤–Ω—ã–µ –¥–æ—Å—Ç–∞–≤–∫–∏</h3></div>
      <div class="table-scroll">
        <table><thead><tr><th>ID</th><th>–ö–ª–∏–µ–Ω—Ç</th><th>–°—Ç–∞—Ç—É—Å</th><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th></tr></thead>
        <tbody id="dashDeliveryBody"></tbody></table>
      </div>
    </div>
  </div>
  <div class="table-wrap mt-24">
    <div class="table-header"><h3>‚ö†Ô∏è –¢–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º –æ—Å—Ç–∞—Ç–∫–æ–º (–º–µ–Ω–µ–µ 10)</h3></div>
    <div class="table-scroll">
      <table><thead><tr><th>–¢–æ–≤–∞—Ä</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–û—Å—Ç–∞—Ç–æ–∫</th><th>–¶–µ–Ω–∞</th></tr></thead>
      <tbody id="dashLowStockBody"></tbody></table>
    </div>
  </div>
</div>

<!-- PRODUCTS -->
<div class="page" id="page-products">
  <div class="page-header">
    <h1>üì¶ –¢–æ–≤–∞—Ä—ã –∏ –æ—Å—Ç–∞—Ç–∫–∏</h1>
    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏, –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è–º–∏</p>
    <div class="page-actions">
      <button class="btn btn-primary" onclick="openProductModal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
      <button class="btn btn-success" onclick="openIncomingModal()">üì• –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ</button>
      <button class="btn btn-outline" onclick="exportProducts()">üìã –≠–∫—Å–ø–æ—Ä—Ç</button>
    </div>
  </div>
  <div class="tabs">
    <button class="tab active" data-tab="products-list">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</button>
    <button class="tab" data-tab="products-incoming">–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</button>
  </div>
  <div class="tab-content active" id="tab-products-list">
    <div class="table-wrap">
      <div class="table-header">
        <h3>–¢–æ–≤–∞—Ä—ã (<span id="productsCount">0</span>)</h3>
        <div class="tools">
          <select id="prodCatFilter" class="search-input" style="width:150px"><option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option><option>–ö–æ—Ñ–µ</option><option>–ß–∞–π</option><option>–î–µ—Å–µ—Ä—Ç—ã</option><option>–ó–∞–≤—Ç—Ä–∞–∫–∏</option><option>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã</option><option>–£–ø–∞–∫–æ–≤–∫–∞</option></select>
          <input type="text" class="search-input" id="prodSearch" placeholder="üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞...">
        </div>
      </div>
      <div class="table-scroll">
        <table>
          <thead><tr><th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–¶–µ–Ω–∞</th><th>–û—Å—Ç–∞—Ç–æ–∫</th><th>–°—Ç–∞—Ç—É—Å</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
          <tbody id="productsBody"></tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="tab-content" id="tab-products-incoming">
    <div class="table-wrap">
      <div class="table-header"><h3>–ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π</h3></div>
      <div class="table-scroll">
        <table>
          <thead><tr><th>–î–∞—Ç–∞</th><th>–¢–æ–≤–∞—Ä</th><th>–ö–æ–ª-–≤–æ</th><th>–ü–æ—Å—Ç–∞–≤—â–∏–∫</th><th>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th></tr></thead>
          <tbody id="incomingBody"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- SALES -->
<div class="page" id="page-sales">
  <div class="page-header">
    <h1>üí∞ –ü—Ä–æ–¥–∞–∂–∏</h1>
    <p>–¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –ø—Ä–æ–¥–∞–∂ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</p>
    <div class="page-actions">
      <button class="btn btn-primary" onclick="openSaleModal()">+ –ù–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞</button>
      <button class="btn btn-outline" onclick="exportSales()">üìã –≠–∫—Å–ø–æ—Ä—Ç</button>
    </div>
  </div>
  <div class="stats-grid" id="salesStats"></div>
  <div class="table-wrap">
    <div class="table-header">
      <h3>–í—Å–µ –ø—Ä–æ–¥–∞–∂–∏ (<span id="salesCount">0</span>)</h3>
      <div class="tools">
        <input type="date" class="search-input" id="salesDateFrom" style="width:150px" title="–î–∞—Ç–∞ –æ—Ç">
        <input type="date" class="search-input" id="salesDateTo" style="width:150px" title="–î–∞—Ç–∞ –¥–æ">
        <input type="text" class="search-input" id="salesSearch" placeholder="üîç –ü–æ–∏—Å–∫...">
      </div>
    </div>
    <div class="table-scroll">
      <table>
        <thead><tr><th>ID</th><th>–î–∞—Ç–∞</th><th>–¢–æ–≤–∞—Ä</th><th>–ö–æ–ª-–≤–æ</th><th>–¶–µ–Ω–∞</th><th>–°—É–º–º–∞</th><th>–û–ø–ª–∞—Ç–∞</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
        <tbody id="salesBody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- DELIVERY -->
<div class="page" id="page-delivery">
  <div class="page-header">
    <h1>üöó –î–æ—Å—Ç–∞–≤–∫–∞</h1>
    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏ –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É</p>
    <div class="page-actions">
      <button class="btn btn-primary" onclick="openDeliveryModal()">+ –ù–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</button>
      <button class="btn btn-outline" onclick="exportDeliveries()">üìã –≠–∫—Å–ø–æ—Ä—Ç</button>
    </div>
  </div>
  <div class="stats-grid" id="deliveryStats"></div>
  <div class="table-wrap">
    <div class="table-header">
      <h3>–í—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏ (<span id="deliveryCount">0</span>)</h3>
      <div class="tools">
        <select id="deliveryStatusFilter" class="search-input" style="width:160px">
          <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
          <option value="new">–ù–æ–≤—ã–π</option>
          <option value="assembling">–°–±–æ—Ä–∫–∞</option>
          <option value="shipping">–í –ø—É—Ç–∏</option>
          <option value="delivered">–î–æ—Å—Ç–∞–≤–ª–µ–Ω</option>
          <option value="cancelled">–û—Ç–º–µ–Ω—ë–Ω</option>
        </select>
        <input type="text" class="search-input" id="deliverySearch" placeholder="üîç –ü–æ–∏—Å–∫...">
      </div>
    </div>
    <div class="table-scroll">
      <table>
        <thead><tr><th>ID</th><th>–î–∞—Ç–∞</th><th>–ö–ª–∏–µ–Ω—Ç</th><th>–ê–¥—Ä–µ—Å</th><th>–°—É–º–º–∞</th><th>–°—Ç–∞—Ç—É—Å</th><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
        <tbody id="deliveryBody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- APPEARANCE -->
<div class="page" id="page-appearance">
  <div class="page-header">
    <h1>üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h1>
    <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</p>
  </div>
  <div class="theme-cards">
    <div class="theme-card theme-card-dark" id="themeCardDark" onclick="setTheme('dark')">
      <h4>üåô –¢—ë–º–Ω–∞—è –∫–æ—Ñ–µ–π–Ω–∞—è</h4>
      <p>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ç—ë–º–Ω–∞—è —Ç–µ–º–∞ —Å –∫–æ—Ñ–µ–π–Ω—ã–º–∏ –æ—Ç—Ç–µ–Ω–∫–∞–º–∏</p>
      <div class="tc-sidebar" style="margin-top:16px">
        <span class="tc-dot tc-dot-1"></span>
        <span class="tc-dot tc-dot-2"></span>
        <span class="tc-dot tc-dot-3"></span>
        <div class="tc-bar accent"></div>
        <div class="tc-bar"></div>
        <div class="tc-bar"></div>
      </div>
      <div class="tc-content">
        <div class="tc-card"><div style="font-size:12px;font-weight:700;color:#a8a29e">–ü—Ä–æ–¥–∞–∂–∏</div><div class="tc-card-bar" style="background:#92400e;width:70%"></div></div>
        <div class="tc-card"><div style="font-size:12px;font-weight:700;color:#a8a29e">–¢–æ–≤–∞—Ä—ã</div><div class="tc-card-bar" style="background:#92400e;width:45%"></div></div>
      </div>
    </div>
    <div class="theme-card theme-card-light" id="themeCardLight" onclick="setTheme('light')">
      <h4>‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è</h4>
      <p>–õ—ë–≥–∫–∞—è —Ç–µ–º–∞ —Å —Å–∏–Ω–∏–º–∏ –∞–∫—Ü–µ–Ω—Ç–∞–º–∏</p>
      <div class="tc-sidebar" style="margin-top:16px">
        <span class="tc-dot tc-dot-1"></span>
        <span class="tc-dot tc-dot-2"></span>
        <span class="tc-dot tc-dot-3"></span>
        <div class="tc-bar accent"></div>
        <div class="tc-bar"></div>
        <div class="tc-bar"></div>
      </div>
      <div class="tc-content">
        <div class="tc-card"><div style="font-size:12px;font-weight:700;color:#64748b">–ü—Ä–æ–¥–∞–∂–∏</div><div class="tc-card-bar" style="background:#3b82f6;width:70%"></div></div>
        <div class="tc-card"><div style="font-size:12px;font-weight:700;color:#64748b">–¢–æ–≤–∞—Ä—ã</div><div class="tc-card-bar" style="background:#3b82f6;width:45%"></div></div>
      </div>
    </div>
  </div>
  <div class="config-panel">
    <h3>‚ÑπÔ∏è –û —Ç–µ–º–∞—Ö</h3>
    <p style="font-size:13px;color:var(--text-secondary);line-height:2">
      üåô <strong>–¢—ë–º–Ω–∞—è –∫–æ—Ñ–µ–π–Ω–∞—è</strong> ‚Äî —Ç—ë–ø–ª—ã–µ –∫–æ—Ñ–µ–π–Ω—ã–µ —Ç–æ–Ω–∞, —Ç—ë–º–Ω–∞—è –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å. –ò–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤–µ—á–µ—Ä–æ–º.<br>
      ‚òÄÔ∏è <strong>–°–≤–µ—Ç–ª–∞—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è</strong> ‚Äî —á–∏—Å—Ç–∞—è —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ —Å —Å–∏–Ω–∏–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º –≤ —Å–∞–π–¥–±–∞—Ä–µ. –õ—ë–≥–∫–∞—è –¥–ª—è –≥–ª–∞–∑ –¥–Ω—ë–º.<br>
      üìå –í–∞—à –≤—ã–±–æ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ.<br>
      üìå –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É –∫–Ω–æ–ø–∫–æ–π-—Ç–æ–≥–≥–ª–æ–º –≤ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏.
    </p>
  </div>
</div>

<!-- SETTINGS -->
<div class="page" id="page-settings">
  <div class="page-header">
    <h1>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI —á–∞—Ç-–±–æ—Ç–∞</h1>
    <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ AI –¥–ª—è —á–∞—Ç-–±–æ—Ç–∞ –Ω–∞ —Å–∞–π—Ç–µ</p>
  </div>
  <div class="config-panel">
    <h3>ü§ñ OpenRouter AI Configuration</h3>
    <div class="config-row">
      <label>AI –≤–∫–ª—é—á—ë–Ω:</label>
      <select id="cfgEnabled"><option value="false">–í—ã–∫–ª—é—á–µ–Ω</option><option value="true">–í–∫–ª—é—á—ë–Ω</option></select>
    </div>
    <div class="config-row">
      <label>API URL:</label>
      <input type="text" id="cfgUrl" value="https://openrouter.ai/api/v1/chat/completions">
    </div>
    <div class="config-row">
      <label>–ú–æ–¥–µ–ª—å:</label>
      <input type="text" id="cfgModel" value="z-ai/glm-4.5-air:free">
    </div>
    <div class="config-row">
      <label>API Key:</label>
      <input type="password" id="cfgKey" placeholder="sk-or-v1-...">
    </div>
    <div class="config-row">
      <label>Max Tokens:</label>
      <input type="number" id="cfgTokens" value="300" min="50" max="2000">
    </div>
    <div style="margin-top:16px;display:flex;gap:12px">
      <button class="btn btn-primary" onclick="saveAIConfig()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button class="btn btn-outline" onclick="testAI()">üß™ –¢–µ—Å—Ç AI</button>
    </div>
    <div id="aiTestResult" style="margin-top:16px;padding:12px;border-radius:8px;background:var(--input-bg);font-size:13px;display:none"></div>
  </div>
  <div class="config-panel">
    <h3>üóÑÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
    <p style="font-size:13px;color:var(--text-secondary);margin-bottom:16px">–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage –≤–∞—à–µ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞.</p>
    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <button class="btn btn-outline" onclick="exportAllData()">üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (JSON)</button>
      <button class="btn btn-outline" onclick="document.getElementById('importFile').click()">üì§ –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
      <input type="file" id="importFile" accept=".json" style="display:none" onchange="importAllData(event)">
      <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
    </div>
  </div>
  <div class="config-panel">
    <h3>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
    <p style="font-size:13px;color:var(--text-secondary);line-height:2">
      üìå –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage ‚Äî –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —ç—Ç–æ–º—É –±—Ä–∞—É–∑–µ—Ä—É<br>
      üìå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≠–∫—Å–ø–æ—Ä—Ç/–ò–º–ø–æ—Ä—Ç –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏<br>
      üìå –î–ª—è AI –Ω—É–∂–µ–Ω –∫–ª—é—á –æ—Ç <a href="https://openrouter.ai" target="_blank" style="color:var(--accent);text-decoration:underline">OpenRouter</a><br>
      üìå <strong>–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∞–π—Ç–µ</strong><br>
      üìå –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã –æ–±–µ –≤–∫–ª–∞–¥–∫–∏ ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    </p>
  </div>
</div>

</main>
</div>

<!-- ===== MODALS ===== -->

<!-- Product Modal -->
<div class="modal-overlay" id="productModal">
  <div class="modal">
    <div class="modal-head">
      <h3 id="productModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>
      <button class="modal-close" onclick="closeModal('productModal')">‚úï</button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="prodEditId">
      <div class="form-row">
        <div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label><input type="text" id="prodName" placeholder="–ö–∞–ø—É—á–∏–Ω–æ"></div>
        <div class="form-group"><label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label><select id="prodCat"><option>–ö–æ—Ñ–µ</option><option>–ß–∞–π</option><option>–î–µ—Å–µ—Ä—Ç—ã</option><option>–ó–∞–≤—Ç—Ä–∞–∫–∏</option><option>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã</option><option>–£–ø–∞–∫–æ–≤–∫–∞</option></select></div>
      </div>
      <div class="form-row">
        <div class="form-group"><label>–¶–µ–Ω–∞ (‚ÇΩ) *</label><input type="number" id="prodPrice" placeholder="250" min="0"></div>
        <div class="form-group"><label>–û—Å—Ç–∞—Ç–æ–∫ (—à—Ç)</label><input type="number" id="prodStock" placeholder="100" min="0"></div>
      </div>
      <div class="form-group"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label><textarea id="prodDesc" rows="2" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ..."></textarea></div>
      <div class="form-group"><label>–≠–º–æ–¥–∑–∏</label><input type="text" id="prodEmoji" placeholder="‚òï" maxlength="4"></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('productModal')">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn btn-primary" onclick="saveProduct()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- Incoming Modal -->
<div class="modal-overlay" id="incomingModal">
  <div class="modal">
    <div class="modal-head">
      <h3>üì• –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
      <button class="modal-close" onclick="closeModal('incomingModal')">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="form-group"><label>–¢–æ–≤–∞—Ä *</label><select id="incProduct"></select></div>
      <div class="form-row">
        <div class="form-group"><label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ *</label><input type="number" id="incQty" placeholder="50" min="1"></div>
        <div class="form-group"><label>–î–∞—Ç–∞</label><input type="date" id="incDate"></div>
      </div>
      <div class="form-group"><label>–ü–æ—Å—Ç–∞–≤—â–∏–∫</label><input type="text" id="incSupplier" placeholder="–û–û–û –ö–æ—Ñ–µ—Ç—Ä–µ–π–¥"></div>
      <div class="form-group"><label>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</label><textarea id="incNote" rows="2" placeholder="–î–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('incomingModal')">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn btn-success" onclick="saveIncoming()">üì• –ü—Ä–∏–Ω—è—Ç—å</button>
    </div>
  </div>
</div>

<!-- Sale Modal -->
<div class="modal-overlay" id="saleModal">
  <div class="modal">
    <div class="modal-head">
      <h3>üí∞ –ù–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞</h3>
      <button class="modal-close" onclick="closeModal('saleModal')">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="form-group"><label>–¢–æ–≤–∞—Ä *</label><select id="saleProduct" onchange="updateSalePrice()"></select></div>
      <div class="form-row">
        <div class="form-group"><label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ *</label><input type="number" id="saleQty" value="1" min="1" oninput="updateSaleTotal()"></div>
        <div class="form-group"><label>–¶–µ–Ω–∞ –∑–∞ –µ–¥. (‚ÇΩ)</label><input type="number" id="salePrice" min="0"></div>
      </div>
      <div class="form-row">
        <div class="form-group"><label>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label><select id="salePayment"><option>–ù–∞–ª–∏—á–Ω—ã–µ</option><option>–ö–∞—Ä—Ç–∞</option><option>Apple/Google Pay</option><option>–°–ë–ü</option><option>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</option></select></div>
        <div class="form-group"><label>–î–∞—Ç–∞</label><input type="date" id="saleDate"></div>
      </div>
      <div class="form-group"><label>–ò—Ç–æ–≥–æ</label><div id="saleTotalDisplay" style="font-size:24px;font-weight:800;color:var(--accent)">0 ‚ÇΩ</div></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('saleModal')">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn btn-primary" onclick="saveSale()">üí∞ –û—Ñ–æ—Ä–º–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- Delivery Modal -->
<div class="modal-overlay" id="deliveryModal">
  <div class="modal">
    <div class="modal-head">
      <h3 id="deliveryModalTitle">üöó –ù–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h3>
      <button class="modal-close" onclick="closeModal('deliveryModal')">‚úï</button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="delEditId">
      <div class="form-row">
        <div class="form-group"><label>–ö–ª–∏–µ–Ω—Ç *</label><input type="text" id="delClient" placeholder="–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"></div>
        <div class="form-group"><label>–¢–µ–ª–µ—Ñ–æ–Ω *</label><input type="tel" id="delPhone" placeholder="+7 (999) 123-45-67"></div>
      </div>
      <div class="form-group"><label>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label><input type="text" id="delAddress" placeholder="—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥.10, –∫–≤.5"></div>
      <div class="form-group"><label>–¢–æ–≤–∞—Ä—ã *</label><input type="text" id="delItems" placeholder="–ö–∞–ø—É—á–∏–Ω–æ x2, –ß–∏–∑–∫–µ–π–∫ x1"></div>
      <div class="form-row">
        <div class="form-group"><label>–°—É–º–º–∞ (‚ÇΩ) *</label><input type="number" id="delSum" placeholder="850" min="0"></div>
        <div class="form-group"><label>ID —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</label><input type="text" id="delEmployee" placeholder="EMP-001"></div>
      </div>
      <div class="form-row">
        <div class="form-group"><label>–°—Ç–∞—Ç—É—Å</label><select id="delStatus"><option value="new">üÜï –ù–æ–≤—ã–π</option><option value="assembling">üì¶ –°–±–æ—Ä–∫–∞</option><option value="shipping">üöó –í –ø—É—Ç–∏</option><option value="delivered">‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω</option><option value="cancelled">‚ùå –û—Ç–º–µ–Ω—ë–Ω</option></select></div>
        <div class="form-group"><label>–î–∞—Ç–∞</label><input type="date" id="delDate"></div>
      </div>
      <div class="form-group"><label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label><textarea id="delComment" rows="2" placeholder="–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∑–∞ 15 –º–∏–Ω..."></textarea></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('deliveryModal')">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn btn-primary" onclick="saveDelivery()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>


<script>
/* ================================================================
   DATA LAYER
   ================================================================ */
function getData(key, fallback) {
  try { var d = localStorage.getItem('bb_' + key); return d ? JSON.parse(d) : fallback; }
  catch(e) { return fallback; }
}
function setData(key, val) { localStorage.setItem('bb_' + key, JSON.stringify(val)); }
function genId() { return 'ID-' + Date.now().toString(36).toUpperCase() + Math.random().toString(36).substr(2,4).toUpperCase(); }
function today() { return new Date().toISOString().split('T')[0]; }
function formatDate(d) { if (!d) return '‚Äî'; var p=d.split('-'); return p[2]+'.'+p[1]+'.'+p[0]; }
function formatMoney(n) { return Number(n).toLocaleString('ru-RU') + ' ‚ÇΩ'; }

/* ================================================================
   THEME
   ================================================================ */
function getTheme() { return localStorage.getItem('bb_admin_theme') || 'dark'; }
function setTheme(theme) {
  document.documentElement.setAttribute('data-theme', theme);
  localStorage.setItem('bb_admin_theme', theme);
  updateThemeCards();
}
function updateThemeCards() {
  var theme = getTheme();
  var dc = document.getElementById('themeCardDark');
  var lc = document.getElementById('themeCardLight');
  if (dc) { dc.classList.toggle('active', theme === 'dark'); }
  if (lc) { lc.classList.toggle('active', theme === 'light'); }
}
// Init theme
(function() {
  var saved = getTheme();
  document.documentElement.setAttribute('data-theme', saved);
})();

document.getElementById('themeToggle').addEventListener('click', function() {
  var current = getTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
  showToast(getTheme() === 'dark' ? 'üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞' : '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞', 'info');
});

/* ================================================================
   DEMO DATA
   ================================================================ */
function initDemoData() {
  var existingProducts = getData('products', null);
  if (!existingProducts || existingProducts.length === 0) {
    var products = [
      {id:genId(),name:'–≠—Å–ø—Ä–µ—Å—Å–æ',cat:'–ö–æ—Ñ–µ',price:150,stock:120,desc:'–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∫—Ä–µ–ø–∫–∏–π –∫–æ—Ñ–µ',emoji:'‚òï'},
      {id:genId(),name:'–ö–∞–ø—É—á–∏–Ω–æ',cat:'–ö–æ—Ñ–µ',price:250,stock:85,desc:'–≠—Å–ø—Ä–µ—Å—Å–æ —Å –Ω–µ–∂–Ω–æ–π –º–æ–ª–æ—á–Ω–æ–π –ø–µ–Ω–∫–æ–π',emoji:'ü•õ'},
      {id:genId(),name:'–õ–∞—Ç—Ç–µ',cat:'–ö–æ—Ñ–µ',price:280,stock:72,desc:'–ú—è–≥–∫–∏–π –∫–æ—Ñ–µ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–æ–ª–æ–∫–∞',emoji:'üç¶'},
      {id:genId(),name:'–§–ª—ç—Ç –£–∞–π—Ç',cat:'–ö–æ—Ñ–µ',price:290,stock:52,desc:'–î–≤–æ–π–Ω–æ–π —ç—Å–ø—Ä–µ—Å—Å–æ —Å –±–∞—Ä—Ö–∞—Ç–Ω—ã–º –º–æ–ª–æ–∫–æ–º',emoji:'‚ú®'},
      {id:genId(),name:'–ú–æ–∫–∫–æ',cat:'–ö–æ—Ñ–µ',price:300,stock:38,desc:'–ö–æ—Ñ–µ —Å —à–æ–∫–æ–ª–∞–¥–æ–º –∏ –≤–∑–±–∏—Ç—ã–º–∏ —Å–ª–∏–≤–∫–∞–º–∏',emoji:'üç´'},
      {id:genId(),name:'–†–∞—Ñ –∫–æ—Ñ–µ',cat:'–ö–æ—Ñ–µ',price:320,stock:45,desc:'–ö–æ—Ñ–µ —Å–æ —Å–ª–∏–≤–∫–∞–º–∏ –∏ –≤–∞–Ω–∏–ª—å–Ω—ã–º —Å–∞—Ö–∞—Ä–æ–º',emoji:'üßÅ'},
      {id:genId(),name:'–ê–π—Å-–∫–æ—Ñ–µ',cat:'–ö–æ—Ñ–µ',price:270,stock:60,desc:'–•–æ–ª–æ–¥–Ω—ã–π –∫–æ—Ñ–µ —Å–æ –ª—å–¥–æ–º',emoji:'üßä'},
      {id:genId(),name:'–ó–µ–ª—ë–Ω—ã–π —á–∞–π',cat:'–ß–∞–π',price:180,stock:90,desc:'–û—Ç–±–æ—Ä–Ω—ã–π —è–ø–æ–Ω—Å–∫–∏–π —Å–µ–Ω—á–∞',emoji:'üçµ'},
      {id:genId(),name:'–ò–≤–∞–Ω-—á–∞–π',cat:'–ß–∞–π',price:200,stock:55,desc:'–§–µ—Ä–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å —è–≥–æ–¥–∞–º–∏',emoji:'üåø'},
      {id:genId(),name:'–ú–∞—Ç—á–∞-–ª–∞—Ç—Ç–µ',cat:'–ß–∞–π',price:300,stock:35,desc:'–Ø–ø–æ–Ω—Å–∫–∏–π —á–∞–π –º–∞—Ç—á–∞ —Å –º–æ–ª–æ–∫–æ–º',emoji:'üçÉ'},
      {id:genId(),name:'–ß–∏–∑–∫–µ–π–∫',cat:'–î–µ—Å–µ—Ä—Ç—ã',price:350,stock:18,desc:'–ù—å—é-–ô–æ—Ä–∫—Å–∫–∏–π —Å–æ —Å–ª–∏–≤–æ—á–Ω—ã–º –∫—Ä–µ–º–æ–º',emoji:'üç∞'},
      {id:genId(),name:'–¢–∏—Ä–∞–º–∏—Å—É',cat:'–î–µ—Å–µ—Ä—Ç—ã',price:380,stock:12,desc:'–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏—Ç–∞–ª—å—è–Ω—Å–∫–∏–π –¥–µ—Å–µ—Ä—Ç',emoji:'üçÆ'},
      {id:genId(),name:'–ö—Ä—É–∞—Å—Å–∞–Ω',cat:'–î–µ—Å–µ—Ä—Ç—ã',price:200,stock:30,desc:'–ú–∞—Å–ª—è–Ω–∏—Å—Ç—ã–π, –≤–æ–∑–¥—É—à–Ω—ã–π, —Ö—Ä—É—Å—Ç—è—â–∏–π',emoji:'ü•ê'},
      {id:genId(),name:'–ú–∞—Ñ—Ñ–∏–Ω',cat:'–î–µ—Å–µ—Ä—Ç—ã',price:220,stock:25,desc:'–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å –∂–∏–¥–∫–æ–π –Ω–∞—á–∏–Ω–∫–æ–π',emoji:'üßÅ'},
      {id:genId(),name:'–ê–≤–æ–∫–∞–¥–æ-—Ç–æ—Å—Ç',cat:'–ó–∞–≤—Ç—Ä–∞–∫–∏',price:420,stock:8,desc:'–° —è–π—Ü–æ–º –ø–∞—à–æ—Ç –∏ –º–∏–∫—Ä–æ–∑–µ–ª–µ–Ω—å—é',emoji:'ü•ë'},
      {id:genId(),name:'–°—ã—Ä–Ω–∏–∫–∏',cat:'–ó–∞–≤—Ç—Ä–∞–∫–∏',price:350,stock:15,desc:'–°–æ —Å–º–µ—Ç–∞–Ω–æ–π –∏ —è–≥–æ–¥–Ω—ã–º —Å–æ—É—Å–æ–º',emoji:'ü•û'},
      {id:genId(),name:'–ë–æ—É–ª —Å –∞—Å–∞–∏',cat:'–ó–∞–≤—Ç—Ä–∞–∫–∏',price:450,stock:20,desc:'–ì—Ä–∞–Ω–æ–ª–∞, —Ñ—Ä—É–∫—Ç—ã –∏ –º—ë–¥',emoji:'ü´ê'},
      {id:genId(),name:'–Ø–π—Ü–∞ –ë–µ–Ω–µ–¥–∏–∫—Ç',cat:'–ó–∞–≤—Ç—Ä–∞–∫–∏',price:480,stock:10,desc:'–° –≥–æ–ª–ª–∞–Ω–¥—Å–∫–∏–º —Å–æ—É—Å–æ–º –Ω–∞ –±—Ä–∏–æ—à–∏',emoji:'üç≥'},
      {id:genId(),name:'–ú–æ–ª–æ–∫–æ 3.2%',cat:'–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã',price:80,stock:200,desc:'–õ–∏—Ç—Ä–æ–≤–∞—è —É–ø–∞–∫–æ–≤–∫–∞',emoji:'ü•õ'},
      {id:genId(),name:'–û–≤—Å—è–Ω–æ–µ –º–æ–ª–æ–∫–æ',cat:'–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã',price:180,stock:50,desc:'–†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ',emoji:'üåæ'},
      {id:genId(),name:'–ö–æ—Ñ–µ –∑—ë—Ä–Ω–∞ 1–∫–≥',cat:'–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã',price:1200,stock:5,desc:'–ê—Ä–∞–±–∏–∫–∞ –≠—Ñ–∏–æ–ø–∏—è',emoji:'‚òï'},
      {id:genId(),name:'–°—Ç–∞–∫–∞–Ω 300–º–ª',cat:'–£–ø–∞–∫–æ–≤–∫–∞',price:8,stock:500,desc:'–ë—É–º–∞–∂–Ω—ã–π',emoji:'ü•§'}
    ];
    setData('products', products);
  }
  if (!getData('sales',null)||getData('sales',[]).length===0) {
    var prods=getData('products',[]);var sales=[];
    var days=[0,0,0,1,1,2,2,3,4,5,6,7,8,9,10];
    for(var i=0;i<15;i++){var p=prods[Math.floor(Math.random()*Math.min(10,prods.length))];if(!p)continue;
    var qty=Math.floor(Math.random()*4)+1;var d=new Date();d.setDate(d.getDate()-days[i]);
    sales.push({id:genId(),product:p.name,qty:qty,price:p.price,total:p.price*qty,
    payment:['–ù–∞–ª–∏—á–Ω—ã–µ','–ö–∞—Ä—Ç–∞','Apple/Google Pay','–°–ë–ü'][Math.floor(Math.random()*4)],date:d.toISOString().split('T')[0]});}
    setData('sales',sales);
  }
  if(!getData('deliveries',null)||getData('deliveries',[]).length===0){
    setData('deliveries',[
      {id:genId(),date:today(),client:'–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞',phone:'+7 (999) 111-22-33',address:'—É–ª. –õ–µ–Ω–∏–Ω–∞, 15, –∫–≤.8',items:'–ö–∞–ø—É—á–∏–Ω–æ x2, –ß–∏–∑–∫–µ–π–∫ x1',sum:850,status:'shipping',employee:'EMP-003',comment:''},
      {id:genId(),date:today(),client:'–î–º–∏—Ç—Ä–∏–π –ö–æ–∑–ª–æ–≤',phone:'+7 (999) 444-55-66',address:'–ø—Ä. –ú–∏—Ä–∞, 42, –æ—Ñ.12',items:'–õ–∞—Ç—Ç–µ x3, –ö—Ä—É–∞—Å—Å–∞–Ω x3',sum:1440,status:'assembling',employee:'EMP-001',comment:'–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∑–∞—Ä–∞–Ω–µ–µ'},
      {id:genId(),date:today(),client:'–ï–ª–µ–Ω–∞ –ü–æ–ø–æ–≤–∞',phone:'+7 (999) 777-88-99',address:'—É–ª. –ì–∞–≥–∞—Ä–∏–Ω–∞, 7',items:'–†–∞—Ñ x1, –¢–∏—Ä–∞–º–∏—Å—É x1',sum:700,status:'new',employee:'',comment:''}
    ]);
  }
  if(!getData('incoming',null)||getData('incoming',[]).length===0){
    setData('incoming',[
      {id:genId(),date:today(),product:'–ö–æ—Ñ–µ –∑—ë—Ä–Ω–∞ 1–∫–≥',qty:10,supplier:'–ö–æ—Ñ–µ–¢—Ä–µ–π–¥',note:'–ê—Ä–∞–±–∏–∫–∞ –≠—Ñ–∏–æ–ø–∏—è'},
      {id:genId(),date:today(),product:'–ú–æ–ª–æ–∫–æ 3.2%',qty:50,supplier:'–ú–æ–ª–æ–∫–æ–û–ø—Ç',note:''}
    ]);
  }
}
initDemoData();

/* ================================================================
   NAVIGATION
   ================================================================ */
var currentPage='dashboard';
document.querySelectorAll('.nav-item').forEach(function(item){
  item.addEventListener('click',function(){
    var page=this.getAttribute('data-page');navigateTo(page);
    document.getElementById('sidebar').classList.remove('open');
    document.getElementById('sidebarOverlay').classList.remove('show');
  });
});
function navigateTo(page){
  currentPage=page;
  document.querySelectorAll('.nav-item').forEach(function(n){n.classList.remove('active')});
  document.querySelectorAll('.page').forEach(function(p){p.classList.remove('active')});
  document.querySelector('.nav-item[data-page="'+page+'"]').classList.add('active');
  document.getElementById('page-'+page).classList.add('active');
  refreshPage(page);
}
document.querySelectorAll('.tab').forEach(function(tab){
  tab.addEventListener('click',function(){
    var tabId=this.getAttribute('data-tab');var parent=this.closest('.page');
    parent.querySelectorAll('.tab').forEach(function(t){t.classList.remove('active')});
    parent.querySelectorAll('.tab-content').forEach(function(c){c.classList.remove('active')});
    this.classList.add('active');document.getElementById('tab-'+tabId).classList.add('active');
  });
});
document.getElementById('burgerBtn').addEventListener('click',function(){
  document.getElementById('sidebar').classList.add('open');
  document.getElementById('sidebarOverlay').classList.add('show');
});
document.getElementById('sidebarOverlay').addEventListener('click',function(){
  document.getElementById('sidebar').classList.remove('open');this.classList.remove('show');
});

/* ================================================================
   TOAST & MODAL
   ================================================================ */
function showToast(msg,type){var t=document.getElementById('toast');t.textContent=msg;t.className='toast '+(type||'success');t.classList.add('show');setTimeout(function(){t.classList.remove('show')},3000)}
function openModal(id){document.getElementById(id).classList.add('open')}
function closeModal(id){document.getElementById(id).classList.remove('open')}
document.querySelectorAll('.modal-overlay').forEach(function(o){o.addEventListener('click',function(e){if(e.target===this)this.classList.remove('open')})});

/* ================================================================
   PRODUCTS
   ================================================================ */
function getProducts(){return getData('products',[])}
function setProducts(arr){setData('products',arr)}

function renderProducts(){
  var products=getProducts();
  var search=document.getElementById('prodSearch').value.toLowerCase();
  var catFilter=document.getElementById('prodCatFilter').value;
  var filtered=products.filter(function(p){
    if(catFilter&&p.cat!==catFilter)return false;
    if(search&&p.name.toLowerCase().indexOf(search)===-1&&p.cat.toLowerCase().indexOf(search)===-1)return false;
    return true;
  });
  document.getElementById('productsCount').textContent=filtered.length;
  var tbody=document.getElementById('productsBody');
  if(!filtered.length){tbody.innerHTML='<tr><td colspan="7" class="table-empty">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</td></tr>';return}
  tbody.innerHTML=filtered.map(function(p){
    var ss=p.stock<=0?'<span class="status red">–ù–µ—Ç</span>':p.stock<10?'<span class="status yellow">–ú–∞–ª–æ ('+p.stock+')</span>':'<span class="status green">–í –Ω–∞–ª–∏—á–∏–∏</span>';
    return '<tr><td class="text-muted" style="font-size:11px">'+p.id+'</td><td><strong>'+(p.emoji||'')+' '+p.name+'</strong>'+(p.desc?'<br><span class="text-muted" style="font-size:11px">'+p.desc+'</span>':'')+'</td><td>'+p.cat+'</td><td class="text-bold">'+formatMoney(p.price)+'</td><td>'+p.stock+' —à—Ç</td><td>'+ss+'</td><td class="actions-cell"><button class="btn-icon" onclick="editProduct(\''+p.id+'\')" title="–†–µ–¥.">‚úèÔ∏è</button><button class="btn-icon danger" onclick="deleteProduct(\''+p.id+'\')" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button></td></tr>';
  }).join('');
}
document.getElementById('prodSearch').addEventListener('input',renderProducts);
document.getElementById('prodCatFilter').addEventListener('change',renderProducts);

function openProductModal(){
  document.getElementById('prodEditId').value='';document.getElementById('prodName').value='';
  document.getElementById('prodCat').value='–ö–æ—Ñ–µ';document.getElementById('prodPrice').value='';
  document.getElementById('prodStock').value='';document.getElementById('prodDesc').value='';
  document.getElementById('prodEmoji').value='';document.getElementById('productModalTitle').textContent='–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä';
  openModal('productModal');
}
function editProduct(id){
  var p=getProducts().find(function(x){return x.id===id});if(!p)return;
  document.getElementById('prodEditId').value=p.id;document.getElementById('prodName').value=p.name;
  document.getElementById('prodCat').value=p.cat;document.getElementById('prodPrice').value=p.price;
  document.getElementById('prodStock').value=p.stock;document.getElementById('prodDesc').value=p.desc||'';
  document.getElementById('prodEmoji').value=p.emoji||'';document.getElementById('productModalTitle').textContent='–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å: '+p.name;
  openModal('productModal');
}
function saveProduct(){
  var name=document.getElementById('prodName').value.trim();var cat=document.getElementById('prodCat').value;
  var price=Number(document.getElementById('prodPrice').value);var stock=Number(document.getElementById('prodStock').value)||0;
  var desc=document.getElementById('prodDesc').value.trim();var emoji=document.getElementById('prodEmoji').value.trim();
  var editId=document.getElementById('prodEditId').value;
  if(!name||!price){showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É','error');return}
  var products=getProducts();
  if(editId){products=products.map(function(p){if(p.id===editId)return{id:p.id,name:name,cat:cat,price:price,stock:stock,desc:desc,emoji:emoji};return p});showToast('‚úÖ –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª—ë–Ω')}
  else{products.push({id:genId(),name:name,cat:cat,price:price,stock:stock,desc:desc,emoji:emoji});showToast('‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω')}
  setProducts(products);closeModal('productModal');renderProducts();
}
function deleteProduct(id){if(!confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?'))return;setProducts(getProducts().filter(function(p){return p.id!==id}));showToast('üóëÔ∏è –¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω');renderProducts()}
function exportProducts(){downloadJSON('products_'+today()+'.json',getProducts());showToast('üìã –≠–∫—Å–ø–æ—Ä—Ç')}

/* ================================================================
   INCOMING
   ================================================================ */
function getIncoming(){return getData('incoming',[])}
function setIncoming(arr){setData('incoming',arr)}
function renderIncoming(){
  var list=getIncoming();var tbody=document.getElementById('incomingBody');
  if(!list.length){tbody.innerHTML='<tr><td colspan="5" class="table-empty">–ù–µ—Ç –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π</td></tr>';return}
  tbody.innerHTML=list.map(function(i){return '<tr><td>'+formatDate(i.date)+'</td><td><strong>'+i.product+'</strong></td><td class="text-bold">+'+i.qty+' —à—Ç</td><td>'+(i.supplier||'‚Äî')+'</td><td class="text-muted">'+(i.note||'‚Äî')+'</td></tr>'}).join('');
}
function openIncomingModal(){
  var products=getProducts();var sel=document.getElementById('incProduct');
  sel.innerHTML=products.map(function(p){return '<option>'+(p.emoji||'')+' '+p.name+'</option>'}).join('');
  document.getElementById('incQty').value='';document.getElementById('incDate').value=today();
  document.getElementById('incSupplier').value='';document.getElementById('incNote').value='';
  openModal('incomingModal');
}
function saveIncoming(){
  var rawVal=document.getElementById('incProduct').value;var qty=Number(document.getElementById('incQty').value);
  var date=document.getElementById('incDate').value||today();var supplier=document.getElementById('incSupplier').value.trim();
  var note=document.getElementById('incNote').value.trim();
  if(!qty||qty<=0){showToast('–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ','error');return}
  var incoming=getIncoming();incoming.unshift({id:genId(),date:date,product:rawVal,qty:qty,supplier:supplier,note:note});setIncoming(incoming);
  var products=getProducts();products=products.map(function(p){if(rawVal.indexOf(p.name)!==-1){p.stock=(p.stock||0)+qty}return p});setProducts(products);
  closeModal('incomingModal');showToast('üì• –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ +'+qty+' —à—Ç');renderProducts();renderIncoming();
}

/* ================================================================
   SALES
   ================================================================ */
function getSales(){return getData('sales',[])}
function setSales(arr){setData('sales',arr)}
function renderSales(){
  var sales=getSales();var search=document.getElementById('salesSearch').value.toLowerCase();
  var df=document.getElementById('salesDateFrom').value;var dt=document.getElementById('salesDateTo').value;
  var filtered=sales.filter(function(s){
    if(search&&s.product.toLowerCase().indexOf(search)===-1&&s.id.toLowerCase().indexOf(search)===-1)return false;
    if(df&&s.date<df)return false;if(dt&&s.date>dt)return false;return true;
  });
  document.getElementById('salesCount').textContent=filtered.length;
  var rev=filtered.reduce(function(a,s){return a+s.total},0);
  var avg=filtered.length?Math.round(rev/filtered.length):0;
  document.getElementById('salesStats').innerHTML=
    statCard('üí∞','amber',formatMoney(rev),'–í—ã—Ä—É—á–∫–∞')+statCard('üì¶','blue',filtered.reduce(function(a,s){return a+s.qty},0),'–ü—Ä–æ–¥–∞–Ω–æ (—à—Ç)')+
    statCard('üßæ','green',filtered.length,'–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π')+statCard('üìä','purple',formatMoney(avg),'–°—Ä–µ–¥–Ω–∏–π —á–µ–∫');
  var tbody=document.getElementById('salesBody');
  if(!filtered.length){tbody.innerHTML='<tr><td colspan="8" class="table-empty">–ù–µ—Ç –ø—Ä–æ–¥–∞–∂</td></tr>';return}
  tbody.innerHTML=filtered.map(function(s){
    return '<tr><td class="text-muted" style="font-size:11px">'+s.id+'</td><td>'+formatDate(s.date)+'</td><td><strong>'+s.product+'</strong></td><td>'+s.qty+'</td><td>'+formatMoney(s.price)+'</td><td class="text-bold text-accent">'+formatMoney(s.total)+'</td><td><span class="status gray">'+s.payment+'</span></td><td><button class="btn-icon danger" onclick="deleteSale(\''+s.id+'\')">üóëÔ∏è</button></td></tr>';
  }).join('');
}
document.getElementById('salesSearch').addEventListener('input',renderSales);
document.getElementById('salesDateFrom').addEventListener('change',renderSales);
document.getElementById('salesDateTo').addEventListener('change',renderSales);

function openSaleModal(){
  var products=getProducts();var sel=document.getElementById('saleProduct');
  sel.innerHTML=products.map(function(p){return '<option value="'+p.id+'" data-price="'+p.price+'">'+(p.emoji||'')+' '+p.name+' ‚Äî '+p.price+'‚ÇΩ (–æ—Å—Ç: '+p.stock+')</option>'}).join('');
  document.getElementById('saleQty').value=1;document.getElementById('saleDate').value=today();
  document.getElementById('salePayment').value='–ö–∞—Ä—Ç–∞';updateSalePrice();openModal('saleModal');
}
function updateSalePrice(){var sel=document.getElementById('saleProduct');var opt=sel.options[sel.selectedIndex];if(opt)document.getElementById('salePrice').value=opt.getAttribute('data-price');updateSaleTotal()}
function updateSaleTotal(){var q=Number(document.getElementById('saleQty').value)||0;var p=Number(document.getElementById('salePrice').value)||0;document.getElementById('saleTotalDisplay').textContent=formatMoney(q*p)}
function saveSale(){
  var sel=document.getElementById('saleProduct');var opt=sel.options[sel.selectedIndex];if(!opt){showToast('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä','error');return}
  var pid=sel.value;var pname=opt.textContent.split(' ‚Äî ')[0].trim();
  var qty=Number(document.getElementById('saleQty').value);var price=Number(document.getElementById('salePrice').value);
  var payment=document.getElementById('salePayment').value;var date=document.getElementById('saleDate').value||today();
  if(!qty||qty<=0||!price){showToast('–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª-–≤–æ –∏ —Ü–µ–Ω—É','error');return}
  var products=getProducts();var prod=products.find(function(p){return p.id===pid});
  if(prod&&prod.stock<qty){showToast('‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ! –û—Å—Ç–∞—Ç–æ–∫: '+prod.stock,'error');return}
  if(prod){products=products.map(function(p){if(p.id===pid)p.stock=Math.max(0,p.stock-qty);return p});setProducts(products)}
  var sales=getSales();sales.unshift({id:genId(),date:date,product:pname,qty:qty,price:price,total:price*qty,payment:payment});setSales(sales);
  closeModal('saleModal');showToast('üí∞ –ü—Ä–æ–¥–∞–∂–∞: '+formatMoney(price*qty));renderSales();renderProducts();
}
function deleteSale(id){if(!confirm('–£–¥–∞–ª–∏—Ç—å?'))return;setSales(getSales().filter(function(s){return s.id!==id}));showToast('üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ');renderSales()}
function exportSales(){downloadJSON('sales_'+today()+'.json',getSales());showToast('üìã –≠–∫—Å–ø–æ—Ä—Ç')}

/* ================================================================
   DELIVERY
   ================================================================ */
function getDeliveries(){return getData('deliveries',[])}
function setDeliveries(arr){setData('deliveries',arr)}
var STATUSES={'new':{label:'–ù–æ–≤—ã–π',cls:'blue',emoji:'üÜï'},'assembling':{label:'–°–±–æ—Ä–∫–∞',cls:'yellow',emoji:'üì¶'},'shipping':{label:'–í –ø—É—Ç–∏',cls:'purple',emoji:'üöó'},'delivered':{label:'–î–æ—Å—Ç–∞–≤–ª–µ–Ω',cls:'green',emoji:'‚úÖ'},'cancelled':{label:'–û—Ç–º–µ–Ω—ë–Ω',cls:'red',emoji:'‚ùå'}};
var STATUS_ORDER=['new','assembling','shipping','delivered'];

function renderDeliveries(){
  var list=getDeliveries();var search=document.getElementById('deliverySearch').value.toLowerCase();
  var sf=document.getElementById('deliveryStatusFilter').value;
  var filtered=list.filter(function(d){
    if(sf&&d.status!==sf)return false;
    if(search){var h=(d.id+d.client+d.address+d.items+d.employee).toLowerCase();if(h.indexOf(search)===-1)return false}
    return true;
  });
  document.getElementById('deliveryCount').textContent=filtered.length;
  var ac=list.filter(function(d){return d.status!=='delivered'&&d.status!=='cancelled'}).length;
  document.getElementById('deliveryBadge').textContent=ac||'';
  document.getElementById('deliveryStats').innerHTML=
    statCard('üÜï','blue',list.filter(function(d){return d.status==='new'}).length,'–ù–æ–≤—ã–µ')+
    statCard('üì¶','amber',list.filter(function(d){return d.status==='assembling'}).length,'–°–±–æ—Ä–∫–∞')+
    statCard('üöó','purple',list.filter(function(d){return d.status==='shipping'}).length,'–í –ø—É—Ç–∏')+
    statCard('‚úÖ','green',list.filter(function(d){return d.status==='delivered'}).length,'–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ');
  var tbody=document.getElementById('deliveryBody');
  if(!filtered.length){tbody.innerHTML='<tr><td colspan="8" class="table-empty">–ù–µ—Ç –¥–æ—Å—Ç–∞–≤–æ–∫</td></tr>';return}
  tbody.innerHTML=filtered.map(function(d){
    var st=STATUSES[d.status]||STATUSES['new'];var tl=renderTimeline(d.status);
    return '<tr><td class="text-muted" style="font-size:11px">'+d.id+'</td><td>'+formatDate(d.date)+'</td><td><strong>'+d.client+'</strong><br><span class="text-muted" style="font-size:11px">'+d.phone+'</span></td><td style="max-width:200px;font-size:12px">'+d.address+'<br><span class="text-muted" style="font-size:11px">'+d.items+'</span></td><td class="text-bold">'+formatMoney(d.sum)+'</td><td><span class="status '+st.cls+'">'+st.emoji+' '+st.label+'</span>'+tl+'</td><td>'+(d.employee||'<span class="text-muted">‚Äî</span>')+'</td><td class="actions-cell">'+(d.status!=='delivered'&&d.status!=='cancelled'?'<button class="btn-icon" onclick="advanceDelivery(\''+d.id+'\')" title="–î–∞–ª–µ–µ">‚è≠Ô∏è</button>':'')+'<button class="btn-icon" onclick="editDelivery(\''+d.id+'\')" title="–†–µ–¥.">‚úèÔ∏è</button><button class="btn-icon danger" onclick="deleteDelivery(\''+d.id+'\')" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button></td></tr>';
  }).join('');
}
function renderTimeline(status){
  if(status==='cancelled')return '';var idx=STATUS_ORDER.indexOf(status);var h='<div class="timeline" style="margin-top:6px">';
  for(var i=0;i<STATUS_ORDER.length;i++){if(i>0)h+='<div class="timeline-line'+(i<=idx?' done':'')+'"></div>';
  var c=i<idx?'done':(i===idx?'current':'');h+='<div class="timeline-dot '+c+'">'+(i<idx?'‚úì':(i+1))+'</div>'}
  h+='</div>';return h;
}
document.getElementById('deliverySearch').addEventListener('input',renderDeliveries);
document.getElementById('deliveryStatusFilter').addEventListener('change',renderDeliveries);

function openDeliveryModal(){
  document.getElementById('delEditId').value='';document.getElementById('delClient').value='';
  document.getElementById('delPhone').value='';document.getElementById('delAddress').value='';
  document.getElementById('delItems').value='';document.getElementById('delSum').value='';
  document.getElementById('delEmployee').value='';document.getElementById('delStatus').value='new';
  document.getElementById('delDate').value=today();document.getElementById('delComment').value='';
  document.getElementById('deliveryModalTitle').textContent='üöó –ù–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞';openModal('deliveryModal');
}
function editDelivery(id){
  var d=getDeliveries().find(function(x){return x.id===id});if(!d)return;
  document.getElementById('delEditId').value=d.id;document.getElementById('delClient').value=d.client;
  document.getElementById('delPhone').value=d.phone;document.getElementById('delAddress').value=d.address;
  document.getElementById('delItems').value=d.items;document.getElementById('delSum').value=d.sum;
  document.getElementById('delEmployee').value=d.employee||'';document.getElementById('delStatus').value=d.status;
  document.getElementById('delDate').value=d.date;document.getElementById('delComment').value=d.comment||'';
  document.getElementById('deliveryModalTitle').textContent='‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å';openModal('deliveryModal');
}
function saveDelivery(){
  var client=document.getElementById('delClient').value.trim();var phone=document.getElementById('delPhone').value.trim();
  var address=document.getElementById('delAddress').value.trim();var items=document.getElementById('delItems').value.trim();
  var sum=Number(document.getElementById('delSum').value);var employee=document.getElementById('delEmployee').value.trim();
  var status=document.getElementById('delStatus').value;var date=document.getElementById('delDate').value||today();
  var comment=document.getElementById('delComment').value.trim();var editId=document.getElementById('delEditId').value;
  if(!client||!phone||!address||!items||!sum){showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è','error');return}
  var deliveries=getDeliveries();
  if(editId){deliveries=deliveries.map(function(d){if(d.id===editId)return{id:d.id,date:date,client:client,phone:phone,address:address,items:items,sum:sum,status:status,employee:employee,comment:comment};return d});showToast('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ')}
  else{deliveries.unshift({id:genId(),date:date,client:client,phone:phone,address:address,items:items,sum:sum,status:status,employee:employee,comment:comment});showToast('‚úÖ –°–æ–∑–¥–∞–Ω–æ')}
  setDeliveries(deliveries);closeModal('deliveryModal');renderDeliveries();
}
function advanceDelivery(id){
  var dl=getDeliveries();dl=dl.map(function(d){if(d.id===id){var i=STATUS_ORDER.indexOf(d.status);if(i<STATUS_ORDER.length-1)d.status=STATUS_ORDER[i+1]}return d});
  setDeliveries(dl);showToast('‚è≠Ô∏è –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—ë–Ω');renderDeliveries();
}
function deleteDelivery(id){if(!confirm('–£–¥–∞–ª–∏—Ç—å?'))return;setDeliveries(getDeliveries().filter(function(d){return d.id!==id}));showToast('üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ');renderDeliveries()}
function exportDeliveries(){downloadJSON('deliveries_'+today()+'.json',getDeliveries());showToast('üìã –≠–∫—Å–ø–æ—Ä—Ç')}

/* ================================================================
   DASHBOARD
   ================================================================ */
function renderDashboard(){
  var products=getProducts();var sales=getSales();var deliveries=getDeliveries();
  var rev=sales.reduce(function(a,s){return a+s.total},0);
  var ac=deliveries.filter(function(d){return d.status!=='delivered'&&d.status!=='cancelled'}).length;
  document.getElementById('dashStats').innerHTML=
    statCard('üí∞','amber',formatMoney(rev),'–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞','+12%','up')+
    statCard('üì¶','blue',products.length,'–¢–æ–≤–∞—Ä–æ–≤','','')+
    statCard('üßæ','green',sales.length,'–ü—Ä–æ–¥–∞–∂','+8%','up')+
    statCard('üöó','purple',ac,'–ê–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ—Å—Ç–∞–≤–æ–∫','','');
  var t1=document.getElementById('dashSalesBody');var rs=sales.slice(0,5);
  t1.innerHTML=rs.length?rs.map(function(s){return '<tr><td>'+s.product+'</td><td>'+s.qty+'</td><td class="text-bold text-accent">'+formatMoney(s.total)+'</td><td>'+formatDate(s.date)+'</td></tr>'}).join(''):'<tr><td colspan="4" class="table-empty">–ù–µ—Ç –ø—Ä–æ–¥–∞–∂</td></tr>';
  var t2=document.getElementById('dashDeliveryBody');var ad=deliveries.filter(function(d){return d.status!=='delivered'&&d.status!=='cancelled'}).slice(0,5);
  t2.innerHTML=ad.length?ad.map(function(d){var st=STATUSES[d.status];return '<tr><td class="text-muted" style="font-size:11px">'+d.id+'</td><td>'+d.client+'</td><td><span class="status '+st.cls+'">'+st.emoji+' '+st.label+'</span></td><td>'+(d.employee||'‚Äî')+'</td></tr>'}).join(''):'<tr><td colspan="4" class="table-empty">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö</td></tr>';
  var t3=document.getElementById('dashLowStockBody');var ls=products.filter(function(p){return p.stock<10}).sort(function(a,b){return a.stock-b.stock});
  t3.innerHTML=ls.length?ls.map(function(p){var c=p.stock===0?'red':'yellow';return '<tr><td><strong>'+(p.emoji||'')+' '+p.name+'</strong></td><td>'+p.cat+'</td><td><span class="status '+c+'">'+p.stock+' —à—Ç</span></td><td>'+formatMoney(p.price)+'</td></tr>'}).join(''):'<tr><td colspan="4" class="table-empty">–í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ üëç</td></tr>';
}
function statCard(emoji,color,value,label,change,dir){
  return '<div class="stat-card"><div class="top"><div class="icon '+color+'">'+emoji+'</div>'+(change?'<span class="change '+dir+'">'+change+'</span>':'')+'</div><h3>'+value+'</h3><div class="label">'+label+'</div></div>';
}

/* ================================================================
   SETTINGS
   ================================================================ */
function loadAIConfig(){
  var c=getData('ai_config',{});
  document.getElementById('cfgEnabled').value=c.enabled?'true':'false';
  document.getElementById('cfgUrl').value=c.apiUrl||'https://openrouter.ai/api/v1/chat/completions';
  document.getElementById('cfgModel').value=c.model||'z-ai/glm-4.5-air:free';
  document.getElementById('cfgKey').value=c.apiKey||'';
  document.getElementById('cfgTokens').value=c.maxTokens||300;
}
function saveAIConfig(){
  setData('ai_config',{enabled:document.getElementById('cfgEnabled').value==='true',apiUrl:document.getElementById('cfgUrl').value.trim(),model:document.getElementById('cfgModel').value.trim(),apiKey:document.getElementById('cfgKey').value.trim(),maxTokens:Number(document.getElementById('cfgTokens').value)||300});
  showToast('üíæ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
}
async function testAI(){
  var r=document.getElementById('aiTestResult');r.style.display='block';r.textContent='‚è≥ –¢–µ—Å—Ç...';r.style.background='var(--warning-bg)';
  var cfg={apiUrl:document.getElementById('cfgUrl').value.trim(),model:document.getElementById('cfgModel').value.trim(),apiKey:document.getElementById('cfgKey').value.trim()};
  if(!cfg.apiKey){r.textContent='‚ùå –í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á';r.style.background='var(--danger-bg)';return}
  try{
    var res=await fetch(cfg.apiUrl,{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+cfg.apiKey},body:JSON.stringify({model:cfg.model,messages:[{role:'system',content:'–û—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º.'},{role:'user',content:'–ü—Ä–∏–≤–µ—Ç!'}],max_tokens:100})});
    if(!res.ok)throw new Error('HTTP '+res.status);var data=await res.json();
    r.textContent='‚úÖ –û—Ç–≤–µ—Ç: '+(data.choices[0].message.content||'–ø—É—Å—Ç–æ');r.style.background='var(--success-bg)';
  }catch(e){r.textContent='‚ùå –û—à–∏–±–∫–∞: '+e.message;r.style.background='var(--danger-bg)'}
}

/* ================================================================
   EXPORT / IMPORT
   ================================================================ */
function downloadJSON(f,d){var b=new Blob([JSON.stringify(d,null,2)],{type:'application/json'});var a=document.createElement('a');a.href=URL.createObjectURL(b);a.download=f;a.click();URL.revokeObjectURL(a.href)}
function exportAllData(){
  downloadJSON('brew_bean_backup_'+today()+'.json',{products:getProducts(),sales:getSales(),deliveries:getDeliveries(),incoming:getIncoming(),ai_config:getData('ai_config',{}),exportDate:new Date().toISOString()});
  showToast('üì• –≠–∫—Å–ø–æ—Ä—Ç');
}
function importAllData(event){
  var file=event.target.files[0];if(!file)return;var reader=new FileReader();
  reader.onload=function(e){try{var d=JSON.parse(e.target.result);if(d.products)setData('products',d.products);if(d.sales)setData('sales',d.sales);if(d.deliveries)setData('deliveries',d.deliveries);if(d.incoming)setData('incoming',d.incoming);if(d.ai_config)setData('ai_config',d.ai_config);showToast('üì§ –ò–º–ø–æ—Ä—Ç');refreshPage(currentPage)}catch(err){showToast('‚ùå –û—à–∏–±–∫–∞','error')}};
  reader.readAsText(file);event.target.value='';
}
function clearAllData(){
  if(!confirm('–£–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ?'))return;if(!confirm('–¢–û–ß–ù–û?'))return;
  ['products','sales','deliveries','incoming','initialized'].forEach(function(k){localStorage.removeItem('bb_'+k)});
  showToast('üóëÔ∏è –û—á–∏—â–µ–Ω–æ');initDemoData();refreshPage(currentPage);
}

/* ================================================================
   REFRESH
   ================================================================ */
function refreshPage(page){
  switch(page){
    case 'dashboard':renderDashboard();break;
    case 'products':renderProducts();renderIncoming();break;
    case 'sales':renderSales();break;
    case 'delivery':renderDeliveries();break;
    case 'appearance':updateThemeCards();break;
    case 'settings':loadAIConfig();break;
  }
}
refreshPage('dashboard');
</script>
</body>
</html>
