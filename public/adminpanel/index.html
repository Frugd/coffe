<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Brew & Bean ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
  <style>
/* ===== THEME VARIABLES ===== */
:root {
  --sidebar-bg: #1c1917;
  --sidebar-text: #a8a29e;
  --sidebar-hover-bg: rgba(255,255,255,.05);
  --sidebar-active-bg: #92400e;
  --sidebar-active-shadow: rgba(146,64,14,.3);
  --sidebar-logo-bg: #92400e;
  --sidebar-width: 260px;

  --main-bg: #f5f5f4;
  --card-bg: #fff;
  --card-border: #f0eeeb;
  --card-shadow: 0 1px 3px rgba(0,0,0,.04);
  --card-hover-shadow: 0 8px 24px rgba(0,0,0,.06);

  --text-primary: #1a1a1a;
  --text-secondary: #888;
  --text-muted: #aaa;
  --accent: #92400e;
  --accent-hover: #78350f;
  --accent-light: #fffbeb;
  --accent-rgb: 146,64,14;

  --input-bg: #fafaf9;
  --input-border: #e5e2de;
  --input-focus: #d97706;
  --table-header-bg: #fafaf9;
  --table-row-hover: #fafaf9;
  --table-border: #f5f5f4;
  --table-stripe: rgba(0,0,0,.015);

  --modal-overlay: rgba(0,0,0,.4);
  --modal-bg: #fff;
  --scrollbar-thumb: #d6d3d1;

  --success: #16a34a; --success-bg: #f0fdf4;
  --warning: #d97706; --warning-bg: #fffbeb;
  --danger: #ef4444; --danger-bg: #fef2f2;
  --info: #2563eb; --info-bg: #eff6ff;
  --purple: #9333ea; --purple-bg: #faf5ff;

  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 14px;
  --radius-xl: 20px;
  --radius-btn: 8px;
  --radius-input: 8px;
  --radius-card: 14px;

  --font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  --font-size-base: 14px;
  --font-weight-heading: 800;
  --line-height: 1.6;

  --spacing-card: 24px;
  --spacing-gap: 16px;
  --td-padding: 12px 16px;

  --transition-speed: .3s;
  --sidebar-position: left;
}

/* ===== RESET ===== */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:var(--font-family);font-size:var(--font-size-base);color:var(--text-primary);background:var(--main-bg);line-height:var(--line-height);-webkit-font-smoothing:antialiased;transition:background var(--transition-speed),color var(--transition-speed)}
a{text-decoration:none;color:inherit}
button{cursor:pointer;border:none;background:none;font:inherit}
input,textarea,select{font:inherit}
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--scrollbar-thumb);border-radius:10px}

/* ===== LAYOUT ===== */
.app{display:flex;min-height:100vh}
.app.sidebar-right{flex-direction:row-reverse}

/* ===== SIDEBAR ===== */
.sidebar{width:var(--sidebar-width);background:var(--sidebar-bg);color:#fff;display:flex;flex-direction:column;position:fixed;top:0;bottom:0;z-index:50;transition:transform var(--transition-speed),width var(--transition-speed),background var(--transition-speed)}
.app:not(.sidebar-right) .sidebar{left:0}
.app.sidebar-right .sidebar{right:0;left:auto}
.sidebar-header{padding:20px 24px;border-bottom:1px solid rgba(255,255,255,.08)}
.sidebar-logo{display:flex;align-items:center;gap:10px;font-size:18px;font-weight:var(--font-weight-heading)}
.sidebar-logo .icon{width:36px;height:36px;border-radius:var(--radius-md);background:var(--sidebar-logo-bg);display:flex;align-items:center;justify-content:center;font-size:16px;transition:background var(--transition-speed)}
.sidebar-logo em{font-style:normal;color:#fbbf24}
.sidebar-sub{font-size:11px;color:rgba(255,255,255,.3);margin-top:4px}
.sidebar-nav{flex:1;padding:16px 12px;overflow-y:auto}
.nav-section{font-size:10px;text-transform:uppercase;letter-spacing:1.5px;color:rgba(255,255,255,.25);padding:12px 12px 8px;font-weight:600}
.nav-item{display:flex;align-items:center;gap:12px;padding:10px 16px;border-radius:var(--radius-md);font-size:var(--font-size-base);font-weight:500;color:var(--sidebar-text);transition:all .2s;margin-bottom:2px;cursor:pointer}
.nav-item:hover{background:var(--sidebar-hover-bg);color:#fff}
.nav-item.active{background:var(--sidebar-active-bg);color:#fff;box-shadow:0 4px 16px var(--sidebar-active-shadow)}
.nav-item .emoji{font-size:18px;width:24px;text-align:center}
.nav-item .badge{margin-left:auto;padding:2px 8px;border-radius:50px;font-size:10px;font-weight:700;background:rgba(239,68,68,.2);color:#ef4444}
.sidebar-footer{padding:16px 20px;border-top:1px solid rgba(255,255,255,.08)}
.sidebar-footer a{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--sidebar-text);transition:color .2s;padding:8px 0}
.sidebar-footer a:hover{color:#fbbf24}

/* ===== MOBILE ===== */
.sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:40}
.sidebar-overlay.show{display:block}
.mobile-header{display:none;position:fixed;top:0;left:0;right:0;z-index:30;background:var(--card-bg);padding:12px 16px;border-bottom:1px solid var(--card-border);align-items:center;gap:12px;transition:background var(--transition-speed)}
.mobile-header .burger{width:40px;height:40px;border-radius:var(--radius-btn);display:flex;align-items:center;justify-content:center;font-size:20px;color:var(--text-secondary)}
.mobile-header .title{font-size:16px;font-weight:700;color:var(--text-primary)}
@media(max-width:768px){
  .sidebar{transform:translateX(-100%)}
  .app.sidebar-right .sidebar{transform:translateX(100%)}
  .sidebar.open{transform:translateX(0)!important}
  .mobile-header{display:flex}
  .main{margin-left:0!important;margin-right:0!important;padding-top:72px!important}
  .dash-grid-2{grid-template-columns:1fr!important}
  .customizer-grid{grid-template-columns:1fr!important}
}

/* ===== MAIN ===== */
.main{flex:1;margin-left:var(--sidebar-width);padding:32px;transition:background var(--transition-speed),margin var(--transition-speed)}
.app.sidebar-right .main{margin-left:0;margin-right:var(--sidebar-width)}
.page{display:none}
.page.active{display:block}
.page-header{margin-bottom:32px}
.page-header h1{font-size:28px;font-weight:var(--font-weight-heading);margin-bottom:4px;color:var(--text-primary)}
.page-header p{font-size:var(--font-size-base);color:var(--text-secondary)}
.page-actions{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}

/* ===== CARDS ===== */
.stats-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:var(--spacing-gap);margin-bottom:32px}
.stat-card{padding:var(--spacing-card);border-radius:var(--radius-card);background:var(--card-bg);border:1px solid var(--card-border);box-shadow:var(--card-shadow);transition:all var(--transition-speed)}
.stat-card:hover{box-shadow:var(--card-hover-shadow);transform:translateY(-2px)}
.stat-card .top{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.stat-card .icon{width:44px;height:44px;border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center;font-size:20px}
.stat-card .icon.amber{background:var(--warning-bg)}.stat-card .icon.green{background:var(--success-bg)}
.stat-card .icon.blue{background:var(--info-bg)}.stat-card .icon.red{background:var(--danger-bg)}.stat-card .icon.purple{background:var(--purple-bg)}
.stat-card .change{font-size:11px;font-weight:600;padding:3px 10px;border-radius:50px}
.stat-card .change.up{background:var(--success-bg);color:var(--success)}
.stat-card .change.down{background:var(--danger-bg);color:var(--danger)}
.stat-card h3{font-size:28px;font-weight:var(--font-weight-heading);color:var(--text-primary)}
.stat-card .label{font-size:12px;color:var(--text-secondary);margin-top:4px}

/* ===== TABLE ===== */
.table-wrap{background:var(--card-bg);border-radius:var(--radius-card);border:1px solid var(--card-border);overflow:hidden;box-shadow:var(--card-shadow);transition:all var(--transition-speed)}
.table-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--card-border);flex-wrap:wrap;gap:12px}
.table-header h3{font-size:16px;font-weight:700;color:var(--text-primary)}
.table-header .tools{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.search-input{padding:8px 14px;border-radius:var(--radius-input);border:1px solid var(--input-border);background:var(--input-bg);font-size:13px;outline:none;width:220px;transition:all .2s;color:var(--text-primary)}
.search-input:focus{border-color:var(--input-focus)}
.table-scroll{overflow-x:auto}
table{width:100%;border-collapse:collapse;min-width:600px}
thead{background:var(--table-header-bg)}
th{padding:var(--td-padding);font-size:11px;font-weight:700;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px;text-align:left;border-bottom:1px solid var(--card-border);white-space:nowrap}
td{padding:var(--td-padding);font-size:13px;border-bottom:1px solid var(--table-border);vertical-align:middle;color:var(--text-primary)}
tr:hover td{background:var(--table-row-hover)}
.table-striped tbody tr:nth-child(even) td{background:var(--table-stripe)}
.table-empty{padding:40px;text-align:center;color:var(--text-muted);font-size:var(--font-size-base)}

/* ===== STATUS ===== */
.status{display:inline-block;padding:3px 12px;border-radius:50px;font-size:11px;font-weight:600}
.status.green{background:var(--success-bg);color:var(--success)}.status.yellow{background:var(--warning-bg);color:var(--warning)}
.status.red{background:var(--danger-bg);color:var(--danger)}.status.blue{background:var(--info-bg);color:var(--info)}
.status.gray{background:var(--table-header-bg);color:var(--text-secondary)}.status.purple{background:var(--purple-bg);color:var(--purple)}

/* ===== BUTTONS ===== */
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 18px;border-radius:var(--radius-btn);font-size:13px;font-weight:600;transition:all .2s;white-space:nowrap;cursor:pointer;border:none}
.btn-primary{background:var(--accent);color:#fff}.btn-primary:hover{background:var(--accent-hover)}
.btn-success{background:var(--success);color:#fff}.btn-success:hover{opacity:.9}
.btn-danger{background:var(--danger);color:#fff}.btn-danger:hover{opacity:.9}
.btn-outline{background:var(--card-bg);color:var(--text-secondary);border:1px solid var(--input-border)}.btn-outline:hover{border-color:var(--accent);color:var(--accent)}
.btn-sm{padding:5px 12px;font-size:11px;border-radius:var(--radius-sm)}
.btn-icon{width:32px;height:32px;padding:0;display:flex;align-items:center;justify-content:center;border-radius:var(--radius-btn);font-size:14px;background:var(--card-bg);border:1px solid var(--input-border);color:var(--text-secondary);transition:all .2s}
.btn-icon:hover{border-color:var(--accent);color:var(--accent)}
.btn-icon.danger:hover{border-color:var(--danger);color:var(--danger)}
.actions-cell{display:flex;gap:6px}

/* ===== MODAL ===== */
.modal-overlay{display:none;position:fixed;inset:0;background:var(--modal-overlay);z-index:100;align-items:center;justify-content:center;padding:24px}
.modal-overlay.open{display:flex}
.modal{background:var(--modal-bg);border-radius:var(--radius-xl);width:100%;max-width:560px;max-height:calc(100vh - 48px);overflow-y:auto;box-shadow:0 24px 64px rgba(0,0,0,.15)}
.modal-head{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid var(--card-border)}
.modal-head h3{font-size:18px;font-weight:700;color:var(--text-primary)}
.modal-close{width:32px;height:32px;border-radius:var(--radius-btn);display:flex;align-items:center;justify-content:center;font-size:18px;color:var(--text-secondary);transition:all .2s}
.modal-close:hover{background:var(--table-header-bg);color:var(--text-primary)}
.modal-body{padding:24px}
.modal-footer{display:flex;gap:12px;justify-content:flex-end;padding:16px 24px;border-top:1px solid var(--card-border)}

/* ===== FORMS ===== */
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:12px;font-weight:600;color:var(--text-secondary);margin-bottom:6px}
.form-group input,.form-group select,.form-group textarea{width:100%;padding:10px 14px;border-radius:var(--radius-input);border:1px solid var(--input-border);background:var(--input-bg);font-size:13px;outline:none;transition:all .2s;color:var(--text-primary)}
.form-group input:focus,.form-group select:focus,.form-group textarea:focus{border-color:var(--input-focus);background:var(--card-bg)}
.form-group textarea{resize:vertical;min-height:60px}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:480px){.form-row{grid-template-columns:1fr}}

/* ===== TABS ===== */
.tabs{display:flex;gap:4px;margin-bottom:24px;border-bottom:2px solid var(--card-border);padding-bottom:0}
.tab{padding:10px 20px;font-size:13px;font-weight:600;color:var(--text-secondary);border-bottom:2px solid transparent;margin-bottom:-2px;transition:all .2s;cursor:pointer;background:none;border-top:none;border-left:none;border-right:none}
.tab:hover{color:var(--accent)}
.tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.tab-content{display:none}
.tab-content.active{display:block}

/* ===== CONFIG PANEL ===== */
.config-panel{background:var(--card-bg);border-radius:var(--radius-card);border:1px solid var(--card-border);padding:var(--spacing-card);margin-bottom:24px;box-shadow:var(--card-shadow);transition:all var(--transition-speed)}
.config-panel h3{font-size:16px;font-weight:700;margin-bottom:16px;color:var(--text-primary)}
.config-row{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--table-border)}
.config-row:last-child{border-bottom:none}
.config-row label{font-size:13px;font-weight:600;min-width:120px;color:var(--text-primary)}
.config-row input,.config-row select{flex:1;padding:8px 12px;border-radius:var(--radius-input);border:1px solid var(--input-border);font-size:13px;outline:none;background:var(--input-bg);color:var(--text-primary)}
.config-row input:focus{border-color:var(--input-focus)}

/* ===== TIMELINE ===== */
.timeline{display:flex;gap:4px;align-items:center}
.timeline-step{display:flex;align-items:center;gap:4px}
.timeline-dot{width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px;border:2px solid var(--input-border);color:var(--text-muted);background:var(--card-bg)}
.timeline-dot.done{border-color:var(--success);background:var(--success);color:#fff}
.timeline-dot.current{border-color:var(--warning);background:var(--warning-bg);color:var(--warning)}
.timeline-line{width:16px;height:2px;background:var(--input-border)}.timeline-line.done{background:var(--success)}

/* ===== CUSTOMIZER ===== */
.customizer-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.customizer-section{background:var(--card-bg);border-radius:var(--radius-card);border:1px solid var(--card-border);padding:20px;box-shadow:var(--card-shadow);transition:all var(--transition-speed)}
.customizer-section h4{font-size:14px;font-weight:700;margin-bottom:16px;color:var(--text-primary);display:flex;align-items:center;gap:8px}
.cust-row{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--table-border);gap:12px}
.cust-row:last-child{border-bottom:none}
.cust-row .cust-label{font-size:12px;font-weight:500;color:var(--text-secondary);white-space:nowrap}
.cust-row .cust-control{display:flex;align-items:center;gap:8px}
.cust-color{width:36px;height:28px;border:2px solid var(--input-border);border-radius:var(--radius-sm);cursor:pointer;padding:0;background:none;outline:none}
.cust-color::-webkit-color-swatch-wrapper{padding:0}
.cust-color::-webkit-color-swatch{border:none;border-radius:3px}
.cust-color::-moz-color-swatch{border:none;border-radius:3px}
.cust-hex{width:80px;padding:4px 8px;border-radius:var(--radius-sm);border:1px solid var(--input-border);font-size:11px;font-family:monospace;text-align:center;background:var(--input-bg);color:var(--text-primary);outline:none}
.cust-hex:focus{border-color:var(--input-focus)}
.cust-slider{width:120px;accent-color:var(--accent)}
.cust-slider-val{font-size:11px;font-family:monospace;color:var(--text-muted);min-width:36px;text-align:right}
.cust-select{padding:6px 10px;border-radius:var(--radius-sm);border:1px solid var(--input-border);font-size:12px;background:var(--input-bg);color:var(--text-primary);outline:none;max-width:160px}
.cust-select:focus{border-color:var(--input-focus)}
.cust-toggle{position:relative;width:44px;height:24px;border-radius:50px;background:var(--input-border);cursor:pointer;transition:background .3s;border:none;padding:0;flex-shrink:0}
.cust-toggle.on{background:var(--accent)}
.cust-toggle::before{content:"";position:absolute;top:2px;left:2px;width:20px;height:20px;border-radius:50%;background:#fff;transition:transform .3s;box-shadow:0 1px 3px rgba(0,0,0,.2)}
.cust-toggle.on::before{transform:translateX(20px)}

/* Preset themes */
.preset-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:12px;margin-bottom:24px}
.preset-card{border-radius:var(--radius-md);padding:14px;cursor:pointer;border:3px solid transparent;transition:all .2s;position:relative;overflow:hidden}
.preset-card:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.1)}
.preset-card.active{border-color:var(--accent)}
.preset-card.active::after{content:"‚úì";position:absolute;top:6px;right:8px;width:20px;height:20px;border-radius:50%;background:var(--accent);color:#fff;font-size:11px;display:flex;align-items:center;justify-content:center;font-weight:700}
.preset-name{font-size:12px;font-weight:700;margin-bottom:8px}
.preset-colors{display:flex;gap:4px}
.preset-dot{width:16px;height:16px;border-radius:50%;border:1px solid rgba(0,0,0,.1)}
.preset-preview{height:40px;border-radius:6px;margin-top:8px;display:flex;gap:2px;overflow:hidden}
.preset-preview div{flex:1}

/* Live preview widget */
.live-preview{background:var(--card-bg);border-radius:var(--radius-card);border:1px solid var(--card-border);padding:20px;box-shadow:var(--card-shadow);margin-bottom:20px}
.live-preview h4{font-size:14px;font-weight:700;margin-bottom:12px;color:var(--text-primary)}
.lp-mini{border-radius:var(--radius-md);overflow:hidden;border:1px solid var(--card-border);display:flex;height:160px;background:var(--main-bg)}
.lp-sidebar{width:60px;background:var(--sidebar-bg);padding:8px 4px;display:flex;flex-direction:column;gap:4px}
.lp-sidebar-dot{width:100%;height:6px;border-radius:3px;background:rgba(255,255,255,.15)}
.lp-sidebar-dot.act{background:var(--sidebar-active-bg)}
.lp-main{flex:1;padding:10px;display:flex;flex-direction:column;gap:8px}
.lp-card{background:var(--card-bg);border-radius:var(--radius-sm);border:1px solid var(--card-border);padding:8px;flex:1}
.lp-bar{height:4px;border-radius:2px;background:var(--accent);margin-bottom:4px}
.lp-bar-2{height:4px;border-radius:2px;background:var(--input-border);width:60%}
.lp-cards-row{display:flex;gap:6px;flex:1}
.lp-btn-preview{display:inline-block;padding:3px 10px;border-radius:var(--radius-btn);background:var(--accent);color:#fff;font-size:9px;font-weight:700;margin-top:4px}

/* ===== MISC ===== */
.text-right{text-align:right}.text-center{text-align:center}
.text-muted{color:var(--text-muted)}.text-bold{font-weight:700}
.text-accent{color:var(--accent)}
.mt-16{margin-top:16px}.mt-24{margin-top:24px}
.mb-16{margin-bottom:16px}.mb-24{margin-bottom:24px}
.dash-grid-2{display:grid;grid-template-columns:1fr 1fr;gap:24px}

/* ===== TOAST ===== */
.toast{position:fixed;top:20px;right:20px;z-index:200;padding:14px 24px;border-radius:var(--radius-md);font-size:13px;font-weight:600;color:#fff;box-shadow:0 8px 30px rgba(0,0,0,.15);transform:translateX(120%);transition:transform .3s;display:flex;align-items:center;gap:8px}
.toast.show{transform:translateX(0)}
.toast.success{background:var(--success)}.toast.error{background:var(--danger)}.toast.info{background:var(--info)}

/* ===== DISABLE ANIMATIONS ===== */
.no-animations,.no-animations *,.no-animations *::before,.no-animations *::after{transition:none!important;animation:none!important}

@media print{
  .sidebar,.mobile-header,.page-actions,.btn,.modal-overlay,.toast,.sidebar-overlay{display:none!important}
  .main{margin-left:0!important;margin-right:0!important;padding:16px!important}
}
  </style>
</head>
<body>

<div class="toast" id="toast"></div>
<div class="mobile-header">
  <button class="burger" id="burgerBtn">‚ò∞</button>
  <span class="title">‚òï –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</span>
</div>
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<div class="app" id="appContainer">

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div class="sidebar-logo"><div class="icon">‚òï</div> Brew <em>&</em> Bean</div>
    <div class="sidebar-sub">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
  </div>
  <nav class="sidebar-nav">
    <div class="nav-section">–û—Å–Ω–æ–≤–Ω–æ–µ</div>
    <div class="nav-item active" data-page="dashboard"><span class="emoji">üìä</span> –î–∞—à–±–æ—Ä–¥</div>
    <div class="nav-item" data-page="products"><span class="emoji">üì¶</span> –¢–æ–≤–∞—Ä—ã</div>
    <div class="nav-item" data-page="sales"><span class="emoji">üí∞</span> –ü—Ä–æ–¥–∞–∂–∏</div>
    <div class="nav-item" data-page="delivery"><span class="emoji">üöó</span> –î–æ—Å—Ç–∞–≤–∫–∞ <span class="badge" id="deliveryBadge"></span></div>
    <div class="nav-section">–°–∏—Å—Ç–µ–º–∞</div>
    <div class="nav-item" data-page="appearance"><span class="emoji">üé®</span> –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</div>
    <div class="nav-item" data-page="settings"><span class="emoji">‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI</div>
  </nav>
  <div class="sidebar-footer">
    <a href="../">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç</a>
  </div>
</aside>

<!-- MAIN -->
<main class="main">

<!-- DASHBOARD -->
<div class="page active" id="page-dashboard">
  <div class="page-header"><h1>üìä –î–∞—à–±–æ—Ä–¥</h1><p>–û–±–∑–æ—Ä –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∫–æ—Ñ–µ–π–Ω–∏</p></div>
  <div class="stats-grid" id="dashStats"></div>
  <div class="dash-grid-2">
    <div class="table-wrap"><div class="table-header"><h3>üî• –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏</h3></div><div class="table-scroll"><table><thead><tr><th>–¢–æ–≤–∞—Ä</th><th>–ö–æ–ª-–≤–æ</th><th>–°—É–º–º–∞</th><th>–î–∞—Ç–∞</th></tr></thead><tbody id="dashSalesBody"></tbody></table></div></div>
    <div class="table-wrap"><div class="table-header"><h3>üöó –ê–∫—Ç–∏–≤–Ω—ã–µ –¥–æ—Å—Ç–∞–≤–∫–∏</h3></div><div class="table-scroll"><table><thead><tr><th>ID</th><th>–ö–ª–∏–µ–Ω—Ç</th><th>–°—Ç–∞—Ç—É—Å</th><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th></tr></thead><tbody id="dashDeliveryBody"></tbody></table></div></div>
  </div>
  <div class="table-wrap mt-24"><div class="table-header"><h3>‚ö†Ô∏è –¢–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º –æ—Å—Ç–∞—Ç–∫–æ–º</h3></div><div class="table-scroll"><table><thead><tr><th>–¢–æ–≤–∞—Ä</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–û—Å—Ç–∞—Ç–æ–∫</th><th>–¶–µ–Ω–∞</th></tr></thead><tbody id="dashLowStockBody"></tbody></table></div></div>
</div>

<!-- PRODUCTS -->
<div class="page" id="page-products">
  <div class="page-header"><h1>üì¶ –¢–æ–≤–∞—Ä—ã –∏ –æ—Å—Ç–∞—Ç–∫–∏</h1><p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏, –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è–º–∏</p>
    <div class="page-actions"><button class="btn btn-primary" onclick="openProductModal()">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button><button class="btn btn-success" onclick="openIncomingModal()">üì• –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ</button><button class="btn btn-outline" onclick="exportProducts()">üìã –≠–∫—Å–ø–æ—Ä—Ç</button></div>
  </div>
  <div class="tabs"><button class="tab active" data-tab="products-list">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</button><button class="tab" data-tab="products-incoming">–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</button></div>
  <div class="tab-content active" id="tab-products-list">
    <div class="table-wrap"><div class="table-header"><h3>–¢–æ–≤–∞—Ä—ã (<span id="productsCount">0</span>)</h3><div class="tools"><select id="prodCatFilter" class="search-input" style="width:150px"><option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option><option>–ö–æ—Ñ–µ</option><option>–ß–∞–π</option><option>–î–µ—Å–µ—Ä—Ç—ã</option><option>–ó–∞–≤—Ç—Ä–∞–∫–∏</option><option>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã</option><option>–£–ø–∞–∫–æ–≤–∫–∞</option></select><input type="text" class="search-input" id="prodSearch" placeholder="üîç –ü–æ–∏—Å–∫..."></div></div><div class="table-scroll"><table><thead><tr><th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–¶–µ–Ω–∞</th><th>–û—Å—Ç–∞—Ç–æ–∫</th><th>–°—Ç–∞—Ç—É—Å</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody id="productsBody"></tbody></table></div></div>
  </div>
  <div class="tab-content" id="tab-products-incoming">
    <div class="table-wrap"><div class="table-header"><h3>–ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π</h3></div><div class="table-scroll"><table><thead><tr><th>–î–∞—Ç–∞</th><th>–¢–æ–≤–∞—Ä</th><th>–ö–æ–ª-–≤–æ</th><th>–ü–æ—Å—Ç–∞–≤—â–∏–∫</th><th>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th></tr></thead><tbody id="incomingBody"></tbody></table></div></div>
  </div>
</div>

<!-- SALES -->
<div class="page" id="page-sales">
  <div class="page-header"><h1>üí∞ –ü—Ä–æ–¥–∞–∂–∏</h1><p>–¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –ø—Ä–æ–¥–∞–∂ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</p>
    <div class="page-actions"><button class="btn btn-primary" onclick="openSaleModal()">+ –ù–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞</button><button class="btn btn-outline" onclick="exportSales()">üìã –≠–∫—Å–ø–æ—Ä—Ç</button></div>
  </div>
  <div class="stats-grid" id="salesStats"></div>
  <div class="table-wrap"><div class="table-header"><h3>–í—Å–µ –ø—Ä–æ–¥–∞–∂–∏ (<span id="salesCount">0</span>)</h3><div class="tools"><input type="date" class="search-input" id="salesDateFrom" style="width:150px" title="–î–∞—Ç–∞ –æ—Ç"><input type="date" class="search-input" id="salesDateTo" style="width:150px" title="–î–∞—Ç–∞ –¥–æ"><input type="text" class="search-input" id="salesSearch" placeholder="üîç –ü–æ–∏—Å–∫..."></div></div><div class="table-scroll"><table><thead><tr><th>ID</th><th>–î–∞—Ç–∞</th><th>–¢–æ–≤–∞—Ä</th><th>–ö–æ–ª-–≤–æ</th><th>–¶–µ–Ω–∞</th><th>–°—É–º–º–∞</th><th>–û–ø–ª–∞—Ç–∞</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody id="salesBody"></tbody></table></div></div>
</div>

<!-- DELIVERY -->
<div class="page" id="page-delivery">
  <div class="page-header"><h1>üöó –î–æ—Å—Ç–∞–≤–∫–∞</h1><p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏ –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É</p>
    <div class="page-actions"><button class="btn btn-primary" onclick="openDeliveryModal()">+ –ù–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</button><button class="btn btn-outline" onclick="exportDeliveries()">üìã –≠–∫—Å–ø–æ—Ä—Ç</button></div>
  </div>
  <div class="stats-grid" id="deliveryStats"></div>
  <div class="table-wrap"><div class="table-header"><h3>–í—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏ (<span id="deliveryCount">0</span>)</h3><div class="tools"><select id="deliveryStatusFilter" class="search-input" style="width:160px"><option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option><option value="new">–ù–æ–≤—ã–π</option><option value="assembling">–°–±–æ—Ä–∫–∞</option><option value="shipping">–í –ø—É—Ç–∏</option><option value="delivered">–î–æ—Å—Ç–∞–≤–ª–µ–Ω</option><option value="cancelled">–û—Ç–º–µ–Ω—ë–Ω</option></select><input type="text" class="search-input" id="deliverySearch" placeholder="üîç –ü–æ–∏—Å–∫..."></div></div><div class="table-scroll"><table><thead><tr><th>ID</th><th>–î–∞—Ç–∞</th><th>–ö–ª–∏–µ–Ω—Ç</th><th>–ê–¥—Ä–µ—Å</th><th>–°—É–º–º–∞</th><th>–°—Ç–∞—Ç—É—Å</th><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody id="deliveryBody"></tbody></table></div></div>
</div>

<!-- APPEARANCE -->
<div class="page" id="page-appearance">
  <div class="page-header"><h1>üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h1><p>–ü–æ–ª–Ω–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</p>
    <div class="page-actions">
      <button class="btn btn-primary" onclick="saveCustomTheme()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–º—É</button>
      <button class="btn btn-outline" onclick="exportTheme()">üì• –≠–∫—Å–ø–æ—Ä—Ç —Ç–µ–º—ã</button>
      <button class="btn btn-outline" onclick="document.getElementById('importThemeFile').click()">üì§ –ò–º–ø–æ—Ä—Ç —Ç–µ–º—ã</button>
      <input type="file" id="importThemeFile" accept=".json" style="display:none" onchange="importTheme(event)">
      <button class="btn btn-danger" onclick="resetTheme()">üîÑ –°–±—Ä–æ—Å</button>
    </div>
  </div>

  <!-- PRESETS -->
  <div class="config-panel">
    <h3>‚ö° –ì–æ—Ç–æ–≤—ã–µ —Ç–µ–º—ã</h3>
    <div class="preset-grid" id="presetGrid"></div>
  </div>

  <!-- LIVE PREVIEW -->
  <div class="live-preview">
    <h4>üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h4>
    <div class="lp-mini" id="livePreview">
      <div class="lp-sidebar">
        <div class="lp-sidebar-dot act"></div>
        <div class="lp-sidebar-dot"></div>
        <div class="lp-sidebar-dot"></div>
        <div class="lp-sidebar-dot"></div>
      </div>
      <div class="lp-main">
        <div class="lp-cards-row">
          <div class="lp-card"><div class="lp-bar" style="width:70%"></div><div class="lp-bar-2"></div></div>
          <div class="lp-card"><div class="lp-bar" style="width:50%"></div><div class="lp-bar-2"></div></div>
          <div class="lp-card"><div class="lp-bar" style="width:90%"></div><div class="lp-bar-2"></div></div>
        </div>
        <div class="lp-card" style="flex:2"><div class="lp-bar" style="width:40%"></div><div class="lp-bar-2" style="width:80%"></div><div class="lp-btn-preview">–ö–Ω–æ–ø–∫–∞</div></div>
      </div>
    </div>
  </div>

  <div class="customizer-grid">
    <!-- COLORS -->
    <div class="customizer-section">
      <h4>üé® –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞</h4>
      <div class="cust-row"><span class="cust-label">–ê–∫—Ü–µ–Ω—Ç</span><div class="cust-control"><input type="color" class="cust-color" data-var="--accent" id="cAcc"><input type="text" class="cust-hex" data-var="--accent" id="cAccHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ê–∫—Ü–µ–Ω—Ç (hover)</span><div class="cust-control"><input type="color" class="cust-color" data-var="--accent-hover" id="cAccH"><input type="text" class="cust-hex" data-var="--accent-hover" id="cAccHHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ê–∫—Ü–µ–Ω—Ç (—Ñ–æ–Ω)</span><div class="cust-control"><input type="color" class="cust-color" data-var="--accent-light" id="cAccL"><input type="text" class="cust-hex" data-var="--accent-light" id="cAccLHex"></div></div>
      <div class="cust-row"><span class="cust-label">–£—Å–ø–µ—Ö</span><div class="cust-control"><input type="color" class="cust-color" data-var="--success" id="cSucc"><input type="text" class="cust-hex" data-var="--success" id="cSuccHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</span><div class="cust-control"><input type="color" class="cust-color" data-var="--warning" id="cWarn"><input type="text" class="cust-hex" data-var="--warning" id="cWarnHex"></div></div>
      <div class="cust-row"><span class="cust-label">–û—à–∏–±–∫–∞</span><div class="cust-control"><input type="color" class="cust-color" data-var="--danger" id="cDang"><input type="text" class="cust-hex" data-var="--danger" id="cDangHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ò–Ω—Ñ–æ</span><div class="cust-control"><input type="color" class="cust-color" data-var="--info" id="cInfo"><input type="text" class="cust-hex" data-var="--info" id="cInfoHex"></div></div>
    </div>

    <!-- SIDEBAR -->
    <div class="customizer-section">
      <h4>üìå –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å</h4>
      <div class="cust-row"><span class="cust-label">–§–æ–Ω</span><div class="cust-control"><input type="color" class="cust-color" data-var="--sidebar-bg" id="cSBg"><input type="text" class="cust-hex" data-var="--sidebar-bg" id="cSBgHex"></div></div>
      <div class="cust-row"><span class="cust-label">–¢–µ–∫—Å—Ç</span><div class="cust-control"><input type="color" class="cust-color" data-var="--sidebar-text" id="cSTxt"><input type="text" class="cust-hex" data-var="--sidebar-text" id="cSTxtHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ê–∫—Ç–∏–≤–Ω—ã–π –ø—É–Ω–∫—Ç</span><div class="cust-control"><input type="color" class="cust-color" data-var="--sidebar-active-bg" id="cSAct"><input type="text" class="cust-hex" data-var="--sidebar-active-bg" id="cSActHex"></div></div>
      <div class="cust-row"><span class="cust-label">–õ–æ–≥–æ (–∏–∫–æ–Ω–∫–∞)</span><div class="cust-control"><input type="color" class="cust-color" data-var="--sidebar-logo-bg" id="cSLogo"><input type="text" class="cust-hex" data-var="--sidebar-logo-bg" id="cSLogoHex"></div></div>
      <div class="cust-row"><span class="cust-label">–®–∏—Ä–∏–Ω–∞</span><div class="cust-control"><input type="range" class="cust-slider" min="200" max="340" step="10" data-var="--sidebar-width" data-unit="px" id="cSW"><span class="cust-slider-val" id="cSWVal">260px</span></div></div>
      <div class="cust-row"><span class="cust-label">–ü–æ–∑–∏—Ü–∏—è</span><div class="cust-control"><select class="cust-select" id="cSPos"><option value="left">–°–ª–µ–≤–∞</option><option value="right">–°–ø—Ä–∞–≤–∞</option></select></div></div>
    </div>

    <!-- BACKGROUND & CARDS -->
    <div class="customizer-section">
      <h4>üñºÔ∏è –§–æ–Ω—ã –∏ –∫–∞—Ä—Ç–æ—á–∫–∏</h4>
      <div class="cust-row"><span class="cust-label">–§–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã</span><div class="cust-control"><input type="color" class="cust-color" data-var="--main-bg" id="cMBg"><input type="text" class="cust-hex" data-var="--main-bg" id="cMBgHex"></div></div>
      <div class="cust-row"><span class="cust-label">–§–æ–Ω –∫–∞—Ä—Ç–æ—á–µ–∫</span><div class="cust-control"><input type="color" class="cust-color" data-var="--card-bg" id="cCBg"><input type="text" class="cust-hex" data-var="--card-bg" id="cCBgHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ì—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ä—Ç–æ—á–µ–∫</span><div class="cust-control"><input type="color" class="cust-color" data-var="--card-border" id="cCBrd"><input type="text" class="cust-hex" data-var="--card-border" id="cCBrdHex"></div></div>
      <div class="cust-row"><span class="cust-label">–§–æ–Ω –º–æ–¥–∞–ª—å–Ω–æ–≥–æ</span><div class="cust-control"><input type="color" class="cust-color" data-var="--modal-bg" id="cMoBg"><input type="text" class="cust-hex" data-var="--modal-bg" id="cMoBgHex"></div></div>
      <div class="cust-row"><span class="cust-label">–§–æ–Ω –∏–Ω–ø—É—Ç–æ–≤</span><div class="cust-control"><input type="color" class="cust-color" data-var="--input-bg" id="cIBg"><input type="text" class="cust-hex" data-var="--input-bg" id="cIBgHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ì—Ä–∞–Ω–∏—Ü–∞ –∏–Ω–ø—É—Ç–æ–≤</span><div class="cust-control"><input type="color" class="cust-color" data-var="--input-border" id="cIBrd"><input type="text" class="cust-hex" data-var="--input-border" id="cIBrdHex"></div></div>
    </div>

    <!-- TEXT -->
    <div class="customizer-section">
      <h4>‚úèÔ∏è –¢–µ–∫—Å—Ç</h4>
      <div class="cust-row"><span class="cust-label">–û—Å–Ω–æ–≤–Ω–æ–π</span><div class="cust-control"><input type="color" class="cust-color" data-var="--text-primary" id="cTP"><input type="text" class="cust-hex" data-var="--text-primary" id="cTPHex"></div></div>
      <div class="cust-row"><span class="cust-label">–í—Ç–æ—Ä–∏—á–Ω—ã–π</span><div class="cust-control"><input type="color" class="cust-color" data-var="--text-secondary" id="cTS"><input type="text" class="cust-hex" data-var="--text-secondary" id="cTSHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ü—Ä–∏–≥–ª—É—à—ë–Ω–Ω—ã–π</span><div class="cust-control"><input type="color" class="cust-color" data-var="--text-muted" id="cTM"><input type="text" class="cust-hex" data-var="--text-muted" id="cTMHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ó–∞–≥–æ–ª–æ–≤–æ–∫ (—à—Ä–∏—Ñ—Ç)</span><div class="cust-control"><input type="range" class="cust-slider" min="600" max="900" step="100" data-var="--font-weight-heading" id="cFWH"><span class="cust-slider-val" id="cFWHVal">800</span></div></div>
    </div>

    <!-- TYPOGRAPHY -->
    <div class="customizer-section">
      <h4>üî§ –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞</h4>
      <div class="cust-row"><span class="cust-label">–®—Ä–∏—Ñ—Ç</span><div class="cust-control"><select class="cust-select" id="cFont" data-var="--font-family">
        <option value="'Segoe UI', system-ui, sans-serif">Segoe UI (–ø–æ —É–º–æ–ª—á.)</option>
        <option value="'Inter', sans-serif">Inter</option>
        <option value="'Roboto', sans-serif">Roboto</option>
        <option value="'Open Sans', sans-serif">Open Sans</option>
        <option value="'Nunito', sans-serif">Nunito</option>
        <option value="'Poppins', sans-serif">Poppins</option>
        <option value="'Montserrat', sans-serif">Montserrat</option>
        <option value="'Ubuntu', sans-serif">Ubuntu</option>
        <option value="'Fira Sans', sans-serif">Fira Sans</option>
        <option value="monospace">Monospace</option>
        <option value="Georgia, serif">Georgia (serif)</option>
      </select></div></div>
      <div class="cust-row"><span class="cust-label">–†–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞</span><div class="cust-control"><input type="range" class="cust-slider" min="12" max="18" step="1" data-var="--font-size-base" data-unit="px" id="cFS"><span class="cust-slider-val" id="cFSVal">14px</span></div></div>
      <div class="cust-row"><span class="cust-label">–í—ã—Å–æ—Ç–∞ —Å—Ç—Ä–æ–∫–∏</span><div class="cust-control"><input type="range" class="cust-slider" min="1.2" max="2.0" step="0.1" data-var="--line-height" id="cLH"><span class="cust-slider-val" id="cLHVal">1.6</span></div></div>
    </div>

    <!-- BORDERS -->
    <div class="customizer-section">
      <h4>‚¨ú –°–∫—Ä—É–≥–ª–µ–Ω–∏—è</h4>
      <div class="cust-row"><span class="cust-label">–ö–∞—Ä—Ç–æ—á–∫–∏</span><div class="cust-control"><input type="range" class="cust-slider" min="0" max="30" step="2" data-var="--radius-card" data-unit="px" id="cRC"><span class="cust-slider-val" id="cRCVal">14px</span></div></div>
      <div class="cust-row"><span class="cust-label">–ö–Ω–æ–ø–∫–∏</span><div class="cust-control"><input type="range" class="cust-slider" min="0" max="25" step="1" data-var="--radius-btn" data-unit="px" id="cRB"><span class="cust-slider-val" id="cRBVal">8px</span></div></div>
      <div class="cust-row"><span class="cust-label">–ò–Ω–ø—É—Ç—ã</span><div class="cust-control"><input type="range" class="cust-slider" min="0" max="20" step="1" data-var="--radius-input" data-unit="px" id="cRI"><span class="cust-slider-val" id="cRIVal">8px</span></div></div>
      <div class="cust-row"><span class="cust-label">–û–±—â–∏–π –º–µ–ª–∫–∏–π</span><div class="cust-control"><input type="range" class="cust-slider" min="0" max="16" step="1" data-var="--radius-sm" data-unit="px" id="cRS"><span class="cust-slider-val" id="cRSVal">6px</span></div></div>
      <div class="cust-row"><span class="cust-label">–û–±—â–∏–π —Å—Ä–µ–¥–Ω–∏–π</span><div class="cust-control"><input type="range" class="cust-slider" min="0" max="20" step="1" data-var="--radius-md" data-unit="px" id="cRM"><span class="cust-slider-val" id="cRMVal">10px</span></div></div>
      <div class="cust-row"><span class="cust-label">–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞</span><div class="cust-control"><input type="range" class="cust-slider" min="0" max="30" step="2" data-var="--radius-xl" data-unit="px" id="cRX"><span class="cust-slider-val" id="cRXVal">20px</span></div></div>
    </div>

    <!-- SPACING -->
    <div class="customizer-section">
      <h4>üìè –û—Ç—Å—Ç—É–ø—ã –∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å</h4>
      <div class="cust-row"><span class="cust-label">–ü–∞–¥–¥–∏–Ω–≥ –∫–∞—Ä—Ç–æ—á–µ–∫</span><div class="cust-control"><input type="range" class="cust-slider" min="12" max="36" step="2" data-var="--spacing-card" data-unit="px" id="cSC"><span class="cust-slider-val" id="cSCVal">24px</span></div></div>
      <div class="cust-row"><span class="cust-label">–ì–∞–ø —Å–µ—Ç–∫–∏</span><div class="cust-control"><input type="range" class="cust-slider" min="8" max="32" step="2" data-var="--spacing-gap" data-unit="px" id="cSG"><span class="cust-slider-val" id="cSGVal">16px</span></div></div>
      <div class="cust-row"><span class="cust-label">–Ø—á–µ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã</span><div class="cust-control"><select class="cust-select" id="cTD">
        <option value="8px 12px">–ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ</option>
        <option value="12px 16px" selected>–û–±—ã—á–Ω—ã–µ</option>
        <option value="16px 20px">–ü—Ä–æ—Å—Ç–æ—Ä–Ω—ã–µ</option>
      </select></div></div>
    </div>

    <!-- TABLE STYLE -->
    <div class="customizer-section">
      <h4>üìä –¢–∞–±–ª–∏—Ü—ã</h4>
      <div class="cust-row"><span class="cust-label">–®–∞–ø–∫–∞ (—Ñ–æ–Ω)</span><div class="cust-control"><input type="color" class="cust-color" data-var="--table-header-bg" id="cTHBg"><input type="text" class="cust-hex" data-var="--table-header-bg" id="cTHBgHex"></div></div>
      <div class="cust-row"><span class="cust-label">–°—Ç—Ä–æ–∫–∞ (hover)</span><div class="cust-control"><input type="color" class="cust-color" data-var="--table-row-hover" id="cTRH"><input type="text" class="cust-hex" data-var="--table-row-hover" id="cTRHHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ì—Ä–∞–Ω–∏—Ü–∞ —Å—Ç—Ä–æ–∫</span><div class="cust-control"><input type="color" class="cust-color" data-var="--table-border" id="cTBrd"><input type="text" class="cust-hex" data-var="--table-border" id="cTBrdHex"></div></div>
      <div class="cust-row"><span class="cust-label">–ó–µ–±—Ä–∞ (–ø–æ–ª–æ—Å—ã)</span><div class="cust-control"><button class="cust-toggle" id="cStripe" onclick="toggleStripe()"></button></div></div>
    </div>

    <!-- EFFECTS -->
    <div class="customizer-section">
      <h4>‚ú® –≠—Ñ—Ñ–µ–∫—Ç—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–∏</h4>
      <div class="cust-row"><span class="cust-label">–ê–Ω–∏–º–∞—Ü–∏–∏</span><div class="cust-control"><button class="cust-toggle on" id="cAnim" onclick="toggleAnimations()"></button></div></div>
      <div class="cust-row"><span class="cust-label">–°–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏</span><div class="cust-control"><input type="range" class="cust-slider" min="0.1" max="0.8" step="0.05" data-var="--transition-speed" data-unit="s" id="cAS"><span class="cust-slider-val" id="cASVal">0.3s</span></div></div>
      <div class="cust-row"><span class="cust-label">–¢–µ–Ω—å –∫–∞—Ä—Ç–æ—á–µ–∫</span><div class="cust-control"><select class="cust-select" id="cCShadow">
        <option value="none">–ë–µ–∑ —Ç–µ–Ω–∏</option>
        <option value="0 1px 3px rgba(0,0,0,.04)" selected>–õ—ë–≥–∫–∞—è</option>
        <option value="0 2px 8px rgba(0,0,0,.08)">–°—Ä–µ–¥–Ω—è—è</option>
        <option value="0 4px 16px rgba(0,0,0,.12)">–°–∏–ª—å–Ω–∞—è</option>
        <option value="0 8px 32px rgba(0,0,0,.18)">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è</option>
      </select></div></div>
      <div class="cust-row"><span class="cust-label">–¢–µ–Ω—å (hover)</span><div class="cust-control"><select class="cust-select" id="cCHShadow">
        <option value="none">–ë–µ–∑ —Ç–µ–Ω–∏</option>
        <option value="0 4px 12px rgba(0,0,0,.06)" selected>–õ—ë–≥–∫–∞—è</option>
        <option value="0 8px 24px rgba(0,0,0,.1)">–°—Ä–µ–¥–Ω—è—è</option>
        <option value="0 12px 40px rgba(0,0,0,.15)">–°–∏–ª—å–Ω–∞—è</option>
      </select></div></div>
      <div class="cust-row"><span class="cust-label">–°–∫—Ä–æ–ª–ª–±–∞—Ä</span><div class="cust-control"><input type="color" class="cust-color" data-var="--scrollbar-thumb" id="cScrT"><input type="text" class="cust-hex" data-var="--scrollbar-thumb" id="cScrTHex"></div></div>
    </div>

    <!-- CUSTOM CSS -->
    <div class="customizer-section" style="grid-column:1/-1">
      <h4>üíª –°–≤–æ–π CSS</h4>
      <p style="font-size:12px;color:var(--text-secondary);margin-bottom:12px">–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ CSS-–ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.</p>
      <textarea id="customCSS" style="width:100%;min-height:100px;padding:12px;border-radius:var(--radius-input);border:1px solid var(--input-border);background:var(--input-bg);color:var(--text-primary);font-family:monospace;font-size:12px;outline:none;resize:vertical" placeholder="/* –ü—Ä–∏–º–µ—Ä:&#10;.sidebar { backdrop-filter: blur(10px); }&#10;.stat-card { border-left: 4px solid var(--accent); }&#10;*/"></textarea>
      <button class="btn btn-outline btn-sm mt-16" onclick="applyCustomCSS()">‚ñ∂Ô∏è –ü—Ä–∏–º–µ–Ω–∏—Ç—å CSS</button>
    </div>
  </div>
</div>

<!-- SETTINGS -->
<div class="page" id="page-settings">
  <div class="page-header"><h1>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI —á–∞—Ç-–±–æ—Ç–∞</h1><p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ AI –¥–ª—è —á–∞—Ç-–±–æ—Ç–∞ –Ω–∞ —Å–∞–π—Ç–µ</p></div>
  <div class="config-panel">
    <h3>ü§ñ OpenRouter AI Configuration</h3>
    <div class="config-row"><label>AI –≤–∫–ª—é—á—ë–Ω:</label><select id="cfgEnabled"><option value="false">–í—ã–∫–ª—é—á–µ–Ω</option><option value="true">–í–∫–ª—é—á—ë–Ω</option></select></div>
    <div class="config-row"><label>API URL:</label><input type="text" id="cfgUrl" value="https://openrouter.ai/api/v1/chat/completions"></div>
    <div class="config-row"><label>–ú–æ–¥–µ–ª—å:</label><input type="text" id="cfgModel" value="z-ai/glm-4.5-air:free"></div>
    <div class="config-row"><label>API Key:</label><input type="password" id="cfgKey" placeholder="sk-or-v1-..."></div>
    <div class="config-row"><label>Max Tokens:</label><input type="number" id="cfgTokens" value="300" min="50" max="2000"></div>
    <div style="margin-top:16px;display:flex;gap:12px">
      <button class="btn btn-primary" onclick="saveAIConfig()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button class="btn btn-outline" onclick="testAI()">üß™ –¢–µ—Å—Ç AI</button>
    </div>
    <div id="aiTestResult" style="margin-top:16px;padding:12px;border-radius:8px;background:var(--input-bg);font-size:13px;display:none"></div>
  </div>
  <div class="config-panel">
    <h3>üóÑÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
    <p style="font-size:13px;color:var(--text-secondary);margin-bottom:16px">–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage –≤–∞—à–µ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞.</p>
    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <button class="btn btn-outline" onclick="exportAllData()">üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (JSON)</button>
      <button class="btn btn-outline" onclick="document.getElementById('importFile').click()">üì§ –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
      <input type="file" id="importFile" accept=".json" style="display:none" onchange="importAllData(event)">
      <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
    </div>
  </div>
</div>

</main>
</div>

<!-- MODALS -->
<div class="modal-overlay" id="productModal"><div class="modal"><div class="modal-head"><h3 id="productModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3><button class="modal-close" onclick="closeModal('productModal')">‚úï</button></div><div class="modal-body"><input type="hidden" id="prodEditId"><div class="form-row"><div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label><input type="text" id="prodName" placeholder="–ö–∞–ø—É—á–∏–Ω–æ"></div><div class="form-group"><label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label><select id="prodCat"><option>–ö–æ—Ñ–µ</option><option>–ß–∞–π</option><option>–î–µ—Å–µ—Ä—Ç—ã</option><option>–ó–∞–≤—Ç—Ä–∞–∫–∏</option><option>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã</option><option>–£–ø–∞–∫–æ–≤–∫–∞</option></select></div></div><div class="form-row"><div class="form-group"><label>–¶–µ–Ω–∞ (‚ÇΩ) *</label><input type="number" id="prodPrice" placeholder="250" min="0"></div><div class="form-group"><label>–û—Å—Ç–∞—Ç–æ–∫ (—à—Ç)</label><input type="number" id="prodStock" placeholder="100" min="0"></div></div><div class="form-group"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label><textarea id="prodDesc" rows="2" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ..."></textarea></div><div class="form-group"><label>–≠–º–æ–¥–∑–∏</label><input type="text" id="prodEmoji" placeholder="‚òï" maxlength="4"></div></div><div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('productModal')">–û—Ç–º–µ–Ω–∞</button><button class="btn btn-primary" onclick="saveProduct()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button></div></div></div>
<div class="modal-overlay" id="incomingModal"><div class="modal"><div class="modal-head"><h3>üì• –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3><button class="modal-close" onclick="closeModal('incomingModal')">‚úï</button></div><div class="modal-body"><div class="form-group"><label>–¢–æ–≤–∞—Ä *</label><select id="incProduct"></select></div><div class="form-row"><div class="form-group"><label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ *</label><input type="number" id="incQty" placeholder="50" min="1"></div><div class="form-group"><label>–î–∞—Ç–∞</label><input type="date" id="incDate"></div></div><div class="form-group"><label>–ü–æ—Å—Ç–∞–≤—â–∏–∫</label><input type="text" id="incSupplier" placeholder="–û–û–û –ö–æ—Ñ–µ—Ç—Ä–µ–π–¥"></div><div class="form-group"><label>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</label><textarea id="incNote" rows="2" placeholder="–î–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea></div></div><div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('incomingModal')">–û—Ç–º–µ–Ω–∞</button><button class="btn btn-success" onclick="saveIncoming()">üì• –ü—Ä–∏–Ω—è—Ç—å</button></div></div></div>
<div class="modal-overlay" id="saleModal"><div class="modal"><div class="modal-head"><h3>üí∞ –ù–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞</h3><button class="modal-close" onclick="closeModal('saleModal')">‚úï</button></div><div class="modal-body"><div class="form-group"><label>–¢–æ–≤–∞—Ä *</label><select id="saleProduct" onchange="updateSalePrice()"></select></div><div class="form-row"><div class="form-group"><label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ *</label><input type="number" id="saleQty" value="1" min="1" oninput="updateSaleTotal()"></div><div class="form-group"><label>–¶–µ–Ω–∞ –∑–∞ –µ–¥. (‚ÇΩ)</label><input type="number" id="salePrice" min="0"></div></div><div class="form-row"><div class="form-group"><label>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label><select id="salePayment"><option>–ù–∞–ª–∏—á–Ω—ã–µ</option><option>–ö–∞—Ä—Ç–∞</option><option>Apple/Google Pay</option><option>–°–ë–ü</option><option>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</option></select></div><div class="form-group"><label>–î–∞—Ç–∞</label><input type="date" id="saleDate"></div></div><div class="form-group"><label>–ò—Ç–æ–≥–æ</label><div id="saleTotalDisplay" style="font-size:24px;font-weight:800;color:var(--accent)">0 ‚ÇΩ</div></div></div><div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('saleModal')">–û—Ç–º–µ–Ω–∞</button><button class="btn btn-primary" onclick="saveSale()">üí∞ –û—Ñ–æ—Ä–º–∏—Ç—å</button></div></div></div>
<div class="modal-overlay" id="deliveryModal"><div class="modal"><div class="modal-head"><h3 id="deliveryModalTitle">üöó –ù–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h3><button class="modal-close" onclick="closeModal('deliveryModal')">‚úï</button></div><div class="modal-body"><input type="hidden" id="delEditId"><div class="form-row"><div class="form-group"><label>–ö–ª–∏–µ–Ω—Ç *</label><input type="text" id="delClient" placeholder="–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"></div><div class="form-group"><label>–¢–µ–ª–µ—Ñ–æ–Ω *</label><input type="tel" id="delPhone" placeholder="+7 (999) 123-45-67"></div></div><div class="form-group"><label>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label><input type="text" id="delAddress" placeholder="—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥.10, –∫–≤.5"></div><div class="form-group"><label>–¢–æ–≤–∞—Ä—ã *</label><input type="text" id="delItems" placeholder="–ö–∞–ø—É—á–∏–Ω–æ x2, –ß–∏–∑–∫–µ–π–∫ x1"></div><div class="form-row"><div class="form-group"><label>–°—É–º–º–∞ (‚ÇΩ) *</label><input type="number" id="delSum" placeholder="850" min="0"></div><div class="form-group"><label>ID —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</label><input type="text" id="delEmployee" placeholder="EMP-001"></div></div><div class="form-row"><div class="form-group"><label>–°—Ç–∞—Ç—É—Å</label><select id="delStatus"><option value="new">üÜï –ù–æ–≤—ã–π</option><option value="assembling">üì¶ –°–±–æ—Ä–∫–∞</option><option value="shipping">üöó –í –ø—É—Ç–∏</option><option value="delivered">‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω</option><option value="cancelled">‚ùå –û—Ç–º–µ–Ω—ë–Ω</option></select></div><div class="form-group"><label>–î–∞—Ç–∞</label><input type="date" id="delDate"></div></div><div class="form-group"><label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label><textarea id="delComment" rows="2" placeholder="–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∑–∞ 15 –º–∏–Ω..."></textarea></div></div><div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('deliveryModal')">–û—Ç–º–µ–Ω–∞</button><button class="btn btn-primary" onclick="saveDelivery()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button></div></div></div>

<style id="customStyleTag"></style>

<script>
/* ================================================================
   DATA LAYER
   ================================================================ */
function getData(k,fb){try{var d=localStorage.getItem('bb_'+k);return d?JSON.parse(d):fb}catch(e){return fb}}
function setData(k,v){localStorage.setItem('bb_'+k,JSON.stringify(v))}
function genId(){return 'ID-'+Date.now().toString(36).toUpperCase()+Math.random().toString(36).substr(2,4).toUpperCase()}
function today(){return new Date().toISOString().split('T')[0]}
function formatDate(d){if(!d)return '‚Äî';var p=d.split('-');return p[2]+'.'+p[1]+'.'+p[0]}
function formatMoney(n){return Number(n).toLocaleString('ru-RU')+' ‚ÇΩ'}

/* ================================================================
   PRESET THEMES
   ================================================================ */
var PRESETS = {
  dark_coffee: {
    name: 'üåô –¢—ë–º–Ω–∞—è –∫–æ—Ñ–µ–π–Ω–∞—è', colors: ['#1c1917','#92400e','#f5f5f4','#fff'],
    vars: {
      '--sidebar-bg':'#1c1917','--sidebar-text':'#a8a29e','--sidebar-active-bg':'#92400e','--sidebar-logo-bg':'#92400e',
      '--main-bg':'#f5f5f4','--card-bg':'#fff','--card-border':'#f0eeeb','--modal-bg':'#fff',
      '--text-primary':'#1a1a1a','--text-secondary':'#888','--text-muted':'#aaa',
      '--accent':'#92400e','--accent-hover':'#78350f','--accent-light':'#fffbeb',
      '--input-bg':'#fafaf9','--input-border':'#e5e2de','--input-focus':'#d97706',
      '--table-header-bg':'#fafaf9','--table-row-hover':'#fafaf9','--table-border':'#f5f5f4',
      '--scrollbar-thumb':'#d6d3d1',
      '--success':'#16a34a','--warning':'#d97706','--danger':'#ef4444','--info':'#2563eb'
    }
  },
  light_blue: {
    name: '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Å–∏–Ω—è—è', colors: ['#1e40af','#2563eb','#f0f4ff','#fff'],
    vars: {
      '--sidebar-bg':'#1e3a8a','--sidebar-text':'rgba(255,255,255,.65)','--sidebar-active-bg':'rgba(255,255,255,.15)','--sidebar-logo-bg':'#3b82f6',
      '--main-bg':'#f0f4ff','--card-bg':'#fff','--card-border':'#e0e7ff','--modal-bg':'#fff',
      '--text-primary':'#1e293b','--text-secondary':'#64748b','--text-muted':'#94a3b8',
      '--accent':'#2563eb','--accent-hover':'#1d4ed8','--accent-light':'#eff6ff',
      '--input-bg':'#f8fafc','--input-border':'#cbd5e1','--input-focus':'#3b82f6',
      '--table-header-bg':'#f8fafc','--table-row-hover':'#f1f5f9','--table-border':'#e2e8f0',
      '--scrollbar-thumb':'#94a3b8',
      '--success':'#059669','--warning':'#d97706','--danger':'#dc2626','--info':'#2563eb'
    }
  },
  midnight: {
    name: 'üåå –ü–æ–ª—É–Ω–æ—á–Ω–∞—è', colors: ['#0f172a','#6366f1','#1e293b','#1e293b'],
    vars: {
      '--sidebar-bg':'#0f172a','--sidebar-text':'#94a3b8','--sidebar-active-bg':'#6366f1','--sidebar-logo-bg':'#6366f1',
      '--main-bg':'#1e293b','--card-bg':'#334155','--card-border':'#475569','--modal-bg':'#334155',
      '--text-primary':'#f1f5f9','--text-secondary':'#94a3b8','--text-muted':'#64748b',
      '--accent':'#6366f1','--accent-hover':'#4f46e5','--accent-light':'#312e81',
      '--input-bg':'#1e293b','--input-border':'#475569','--input-focus':'#6366f1',
      '--table-header-bg':'#1e293b','--table-row-hover':'#3b4c63','--table-border':'#475569',
      '--scrollbar-thumb':'#475569',
      '--success':'#34d399','--warning':'#fbbf24','--danger':'#f87171','--info':'#60a5fa'
    }
  },
  forest: {
    name: 'üå≤ –õ–µ—Å–Ω–∞—è', colors: ['#14532d','#16a34a','#f0fdf4','#fff'],
    vars: {
      '--sidebar-bg':'#14532d','--sidebar-text':'#86efac','--sidebar-active-bg':'#16a34a','--sidebar-logo-bg':'#16a34a',
      '--main-bg':'#f0fdf4','--card-bg':'#fff','--card-border':'#bbf7d0','--modal-bg':'#fff',
      '--text-primary':'#14532d','--text-secondary':'#4ade80','--text-muted':'#86efac',
      '--accent':'#16a34a','--accent-hover':'#15803d','--accent-light':'#dcfce7',
      '--input-bg':'#f0fdf4','--input-border':'#86efac','--input-focus':'#16a34a',
      '--table-header-bg':'#f0fdf4','--table-row-hover':'#dcfce7','--table-border':'#bbf7d0',
      '--scrollbar-thumb':'#86efac',
      '--success':'#16a34a','--warning':'#ca8a04','--danger':'#dc2626','--info':'#0284c7'
    }
  },
  sunset: {
    name: 'üåÖ –ó–∞–∫–∞—Ç', colors: ['#7c2d12','#ea580c','#fff7ed','#fff'],
    vars: {
      '--sidebar-bg':'#7c2d12','--sidebar-text':'#fdba74','--sidebar-active-bg':'#ea580c','--sidebar-logo-bg':'#ea580c',
      '--main-bg':'#fff7ed','--card-bg':'#fff','--card-border':'#fed7aa','--modal-bg':'#fff',
      '--text-primary':'#431407','--text-secondary':'#c2410c','--text-muted':'#fb923c',
      '--accent':'#ea580c','--accent-hover':'#c2410c','--accent-light':'#ffedd5',
      '--input-bg':'#fff7ed','--input-border':'#fdba74','--input-focus':'#ea580c',
      '--table-header-bg':'#fff7ed','--table-row-hover':'#ffedd5','--table-border':'#fed7aa',
      '--scrollbar-thumb':'#fdba74',
      '--success':'#16a34a','--warning':'#d97706','--danger':'#dc2626','--info':'#2563eb'
    }
  },
  rose: {
    name: 'üå∏ –†–æ–∑–æ–≤–∞—è', colors: ['#881337','#e11d48','#fff1f2','#fff'],
    vars: {
      '--sidebar-bg':'#881337','--sidebar-text':'#fda4af','--sidebar-active-bg':'#e11d48','--sidebar-logo-bg':'#e11d48',
      '--main-bg':'#fff1f2','--card-bg':'#fff','--card-border':'#fecdd3','--modal-bg':'#fff',
      '--text-primary':'#4c0519','--text-secondary':'#e11d48','--text-muted':'#fb7185',
      '--accent':'#e11d48','--accent-hover':'#be123c','--accent-light':'#ffe4e6',
      '--input-bg':'#fff1f2','--input-border':'#fda4af','--input-focus':'#e11d48',
      '--table-header-bg':'#fff1f2','--table-row-hover':'#ffe4e6','--table-border':'#fecdd3',
      '--scrollbar-thumb':'#fda4af',
      '--success':'#16a34a','--warning':'#d97706','--danger':'#dc2626','--info':'#2563eb'
    }
  },
  cyberpunk: {
    name: 'ü§ñ –ö–∏–±–µ—Ä–ø–∞–Ω–∫', colors: ['#18181b','#06b6d4','#27272a','#27272a'],
    vars: {
      '--sidebar-bg':'#09090b','--sidebar-text':'#a1a1aa','--sidebar-active-bg':'#06b6d4','--sidebar-logo-bg':'#06b6d4',
      '--main-bg':'#18181b','--card-bg':'#27272a','--card-border':'#3f3f46','--modal-bg':'#27272a',
      '--text-primary':'#fafafa','--text-secondary':'#a1a1aa','--text-muted':'#71717a',
      '--accent':'#06b6d4','--accent-hover':'#0891b2','--accent-light':'#164e63',
      '--input-bg':'#18181b','--input-border':'#3f3f46','--input-focus':'#06b6d4',
      '--table-header-bg':'#18181b','--table-row-hover':'#303036','--table-border':'#3f3f46',
      '--scrollbar-thumb':'#3f3f46',
      '--success':'#22d3ee','--warning':'#facc15','--danger':'#f43f5e','--info':'#818cf8'
    }
  },
  lavender: {
    name: 'üíú –õ–∞–≤–∞–Ω–¥–æ–≤–∞—è', colors: ['#4c1d95','#8b5cf6','#f5f3ff','#fff'],
    vars: {
      '--sidebar-bg':'#4c1d95','--sidebar-text':'#c4b5fd','--sidebar-active-bg':'#8b5cf6','--sidebar-logo-bg':'#8b5cf6',
      '--main-bg':'#f5f3ff','--card-bg':'#fff','--card-border':'#ddd6fe','--modal-bg':'#fff',
      '--text-primary':'#1e1b4b','--text-secondary':'#7c3aed','--text-muted':'#a78bfa',
      '--accent':'#8b5cf6','--accent-hover':'#7c3aed','--accent-light':'#ede9fe',
      '--input-bg':'#f5f3ff','--input-border':'#c4b5fd','--input-focus':'#8b5cf6',
      '--table-header-bg':'#f5f3ff','--table-row-hover':'#ede9fe','--table-border':'#ddd6fe',
      '--scrollbar-thumb':'#c4b5fd',
      '--success':'#10b981','--warning':'#f59e0b','--danger':'#ef4444','--info':'#3b82f6'
    }
  },
  minimal: {
    name: '‚¨ú –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è', colors: ['#fff','#18181b','#fafafa','#fff'],
    vars: {
      '--sidebar-bg':'#ffffff','--sidebar-text':'#71717a','--sidebar-active-bg':'#18181b','--sidebar-logo-bg':'#18181b',
      '--main-bg':'#fafafa','--card-bg':'#fff','--card-border':'#e4e4e7','--modal-bg':'#fff',
      '--text-primary':'#09090b','--text-secondary':'#71717a','--text-muted':'#a1a1aa',
      '--accent':'#18181b','--accent-hover':'#27272a','--accent-light':'#f4f4f5',
      '--input-bg':'#fafafa','--input-border':'#d4d4d8','--input-focus':'#18181b',
      '--table-header-bg':'#fafafa','--table-row-hover':'#f4f4f5','--table-border':'#e4e4e7',
      '--scrollbar-thumb':'#d4d4d8',
      '--success':'#16a34a','--warning':'#d97706','--danger':'#dc2626','--info':'#2563eb'
    }
  }
};

var activePreset = 'dark_coffee';

/* ================================================================
   CUSTOMIZER ENGINE
   ================================================================ */
var root = document.documentElement;

function setCSSVar(name, value) {
  root.style.setProperty(name, value);
}

function getCSSVar(name) {
  return getComputedStyle(root).getPropertyValue(name).trim();
}

// Color pickers sync with hex inputs
document.querySelectorAll('.cust-color').forEach(function(picker) {
  picker.addEventListener('input', function() {
    var varName = this.getAttribute('data-var');
    var hexInput = this.parentElement.querySelector('.cust-hex');
    if (hexInput) hexInput.value = this.value;
    setCSSVar(varName, this.value);
    activePreset = 'custom';
    updatePresetCards();
  });
});
document.querySelectorAll('.cust-hex').forEach(function(inp) {
  inp.addEventListener('input', function() {
    var varName = this.getAttribute('data-var');
    var picker = this.parentElement.querySelector('.cust-color');
    if (/^#[0-9a-fA-F]{6}$/.test(this.value)) {
      if (picker) picker.value = this.value;
      setCSSVar(varName, this.value);
      activePreset = 'custom';
      updatePresetCards();
    }
  });
});

// Sliders
document.querySelectorAll('.cust-slider').forEach(function(slider) {
  slider.addEventListener('input', function() {
    var varName = this.getAttribute('data-var');
    var unit = this.getAttribute('data-unit') || '';
    var valSpan = document.getElementById(this.id + 'Val');
    if (valSpan) valSpan.textContent = this.value + unit;
    setCSSVar(varName, this.value + unit);
    activePreset = 'custom';
    updatePresetCards();
  });
});

// Font select
document.getElementById('cFont').addEventListener('change', function() {
  setCSSVar('--font-family', this.value);
  // Load Google Font if needed
  var fontName = this.value.split("'")[1];
  if (fontName && !['Segoe UI','monospace','Georgia'].includes(fontName)) {
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = 'https://fonts.googleapis.com/css2?family=' + fontName.replace(/ /g,'+') + ':wght@400;500;600;700;800;900&display=swap';
    document.head.appendChild(link);
  }
  activePreset = 'custom';
  updatePresetCards();
});

// Sidebar position
document.getElementById('cSPos').addEventListener('change', function() {
  var app = document.getElementById('appContainer');
  if (this.value === 'right') {
    app.classList.add('sidebar-right');
  } else {
    app.classList.remove('sidebar-right');
  }
});

// Table cell density
document.getElementById('cTD').addEventListener('change', function() {
  setCSSVar('--td-padding', this.value);
});

// Card shadow
document.getElementById('cCShadow').addEventListener('change', function() {
  setCSSVar('--card-shadow', this.value);
});
document.getElementById('cCHShadow').addEventListener('change', function() {
  setCSSVar('--card-hover-shadow', this.value);
});

// Toggles
function toggleStripe() {
  var btn = document.getElementById('cStripe');
  btn.classList.toggle('on');
  document.querySelectorAll('table').forEach(function(t) {
    t.closest('.table-wrap')?.classList.toggle('table-striped', btn.classList.contains('on'));
  });
}
function toggleAnimations() {
  var btn = document.getElementById('cAnim');
  btn.classList.toggle('on');
  document.body.classList.toggle('no-animations', !btn.classList.contains('on'));
}

// Custom CSS
function applyCustomCSS() {
  document.getElementById('customStyleTag').textContent = document.getElementById('customCSS').value;
  showToast('‚úÖ CSS –ø—Ä–∏–º–µ–Ω—ë–Ω');
}

/* ================================================================
   PRESETS
   ================================================================ */
function renderPresets() {
  var html = '';
  for (var key in PRESETS) {
    var p = PRESETS[key];
    var active = activePreset === key ? ' active' : '';
    html += '<div class="preset-card' + active + '" data-preset="' + key + '" onclick="applyPreset(\'' + key + '\')" style="background:' + p.colors[2] + '">';
    html += '<div class="preset-name" style="color:' + p.vars['--text-primary'] + '">' + p.name + '</div>';
    html += '<div class="preset-colors">';
    p.colors.forEach(function(c) { html += '<div class="preset-dot" style="background:' + c + '"></div>'; });
    html += '</div>';
    html += '<div class="preset-preview">';
    html += '<div style="background:' + p.colors[0] + ';flex:.3"></div>';
    html += '<div style="background:' + p.colors[2] + ';flex:.7;display:flex;flex-direction:column;justify-content:center;padding:4px">';
    html += '<div style="height:4px;width:60%;background:' + p.colors[1] + ';border-radius:2px;margin:2px"></div>';
    html += '<div style="height:4px;width:40%;background:' + (p.vars['--input-border']||'#ccc') + ';border-radius:2px;margin:2px"></div>';
    html += '</div></div></div>';
  }
  document.getElementById('presetGrid').innerHTML = html;
}

function applyPreset(key) {
  var p = PRESETS[key];
  if (!p) return;
  activePreset = key;
  for (var v in p.vars) {
    setCSSVar(v, p.vars[v]);
  }
  syncAllControls();
  updatePresetCards();
  showToast('üé® –¢–µ–º–∞: ' + p.name);
}

function updatePresetCards() {
  document.querySelectorAll('.preset-card').forEach(function(c) {
    c.classList.toggle('active', c.getAttribute('data-preset') === activePreset);
  });
}

function syncAllControls() {
  // Sync color pickers with current CSS variables
  document.querySelectorAll('.cust-color').forEach(function(picker) {
    var varName = picker.getAttribute('data-var');
    var val = getCSSVar(varName);
    var hexInput = picker.parentElement.querySelector('.cust-hex');
    // Convert to hex if possible
    try {
      if (val.startsWith('#')) { picker.value = val.length === 4 ? expandHex(val) : val; }
      else if (val.startsWith('rgb')) { picker.value = rgbToHex(val); }
      else { picker.value = val; }
    } catch(e) { /* some values like rgba can't be set on color input */ }
    if (hexInput) hexInput.value = picker.value;
  });
  // Sync sliders
  document.querySelectorAll('.cust-slider').forEach(function(slider) {
    var varName = slider.getAttribute('data-var');
    var unit = slider.getAttribute('data-unit') || '';
    var val = getCSSVar(varName).replace(unit, '').replace('s','').trim();
    if (val) slider.value = parseFloat(val);
    var valSpan = document.getElementById(slider.id + 'Val');
    if (valSpan) valSpan.textContent = slider.value + unit;
  });
}

function expandHex(h) { return '#' + h[1]+h[1]+h[2]+h[2]+h[3]+h[3]; }
function rgbToHex(rgb) {
  var m = rgb.match(/(\d+)/g);
  if (!m || m.length < 3) return '#000000';
  return '#' + m.slice(0,3).map(function(x){return ('0'+parseInt(x).toString(16)).slice(-2)}).join('');
}

/* ================================================================
   SAVE / LOAD / EXPORT THEME
   ================================================================ */
function saveCustomTheme() {
  var theme = { preset: activePreset, vars: {}, options: {} };
  // Capture all CSS vars
  var allVars = ['--sidebar-bg','--sidebar-text','--sidebar-active-bg','--sidebar-logo-bg','--sidebar-width',
    '--main-bg','--card-bg','--card-border','--modal-bg','--input-bg','--input-border','--input-focus',
    '--text-primary','--text-secondary','--text-muted','--accent','--accent-hover','--accent-light',
    '--table-header-bg','--table-row-hover','--table-border','--scrollbar-thumb',
    '--success','--warning','--danger','--info',
    '--radius-card','--radius-btn','--radius-input','--radius-sm','--radius-md','--radius-xl',
    '--font-family','--font-size-base','--font-weight-heading','--line-height',
    '--spacing-card','--spacing-gap','--td-padding','--transition-speed',
    '--card-shadow','--card-hover-shadow'];
  allVars.forEach(function(v) { theme.vars[v] = getCSSVar(v); });
  theme.options.sidebarPosition = document.getElementById('cSPos').value;
  theme.options.stripedTables = document.getElementById('cStripe').classList.contains('on');
  theme.options.animations = document.getElementById('cAnim').classList.contains('on');
  theme.options.customCSS = document.getElementById('customCSS').value;
  theme.options.font = document.getElementById('cFont').value;
  setData('admin_theme', theme);
  showToast('üíæ –¢–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞');
}

function loadSavedTheme() {
  var theme = getData('admin_theme', null);
  if (!theme) return;
  activePreset = theme.preset || 'dark_coffee';
  if (theme.vars) {
    for (var v in theme.vars) {
      if (theme.vars[v]) setCSSVar(v, theme.vars[v]);
    }
  }
  if (theme.options) {
    if (theme.options.sidebarPosition === 'right') {
      document.getElementById('appContainer').classList.add('sidebar-right');
      document.getElementById('cSPos').value = 'right';
    }
    if (theme.options.stripedTables) {
      document.getElementById('cStripe').classList.add('on');
      toggleStripe(); toggleStripe(); // apply state
    }
    if (theme.options.animations === false) {
      document.getElementById('cAnim').classList.remove('on');
      document.body.classList.add('no-animations');
    }
    if (theme.options.customCSS) {
      document.getElementById('customCSS').value = theme.options.customCSS;
      document.getElementById('customStyleTag').textContent = theme.options.customCSS;
    }
    if (theme.options.font) {
      document.getElementById('cFont').value = theme.options.font;
      var fontName = theme.options.font.split("'")[1];
      if (fontName && !['Segoe UI','monospace','Georgia'].includes(fontName)) {
        var link = document.createElement('link');
        link.rel='stylesheet';
        link.href='https://fonts.googleapis.com/css2?family='+fontName.replace(/ /g,'+')+':wght@400;500;600;700;800;900&display=swap';
        document.head.appendChild(link);
      }
    }
  }
  syncAllControls();
}

function resetTheme() {
  if (!confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è?')) return;
  localStorage.removeItem('bb_admin_theme');
  // Remove inline styles
  root.removeAttribute('style');
  document.getElementById('appContainer').classList.remove('sidebar-right');
  document.getElementById('cSPos').value = 'left';
  document.getElementById('cStripe').classList.remove('on');
  document.getElementById('cAnim').classList.add('on');
  document.body.classList.remove('no-animations');
  document.getElementById('customCSS').value = '';
  document.getElementById('customStyleTag').textContent = '';
  document.getElementById('cFont').value = "'Segoe UI', system-ui, sans-serif";
  activePreset = 'dark_coffee';
  syncAllControls();
  updatePresetCards();
  showToast('üîÑ –¢–µ–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞');
}

function exportTheme() {
  saveCustomTheme();
  var theme = getData('admin_theme', {});
  downloadJSON('bb_theme_' + today() + '.json', theme);
  showToast('üì• –¢–µ–º–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞');
}

function importTheme(event) {
  var file = event.target.files[0]; if (!file) return;
  var reader = new FileReader();
  reader.onload = function(e) {
    try {
      var theme = JSON.parse(e.target.result);
      setData('admin_theme', theme);
      loadSavedTheme();
      renderPresets();
      showToast('üì§ –¢–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞');
    } catch(err) { showToast('‚ùå –û—à–∏–±–∫–∞ —Ñ–∞–π–ª–∞', 'error'); }
  };
  reader.readAsText(file); event.target.value = '';
}

/* ================================================================
   DEMO DATA
   ================================================================ */
function initDemoData() {
  var ep = getData('products', null);
  if (!ep || ep.length === 0) {
    var products = [
      {id:genId(),name:'–≠—Å–ø—Ä–µ—Å—Å–æ',cat:'–ö–æ—Ñ–µ',price:150,stock:120,desc:'–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∫—Ä–µ–ø–∫–∏–π –∫–æ—Ñ–µ',emoji:'‚òï'},
      {id:genId(),name:'–ö–∞–ø—É—á–∏–Ω–æ',cat:'–ö–æ—Ñ–µ',price:250,stock:85,desc:'–≠—Å–ø—Ä–µ—Å—Å–æ —Å –º–æ–ª–æ—á–Ω–æ–π –ø–µ–Ω–∫–æ–π',emoji:'ü•õ'},
      {id:genId(),name:'–õ–∞—Ç—Ç–µ',cat:'–ö–æ—Ñ–µ',price:280,stock:72,desc:'–ú—è–≥–∫–∏–π –∫–æ—Ñ–µ —Å –º–æ–ª–æ–∫–æ–º',emoji:'üç¶'},
      {id:genId(),name:'–§–ª—ç—Ç –£–∞–π—Ç',cat:'–ö–æ—Ñ–µ',price:290,stock:52,desc:'–î–≤–æ–π–Ω–æ–π —ç—Å–ø—Ä–µ—Å—Å–æ —Å –º–æ–ª–æ–∫–æ–º',emoji:'‚ú®'},
      {id:genId(),name:'–ú–æ–∫–∫–æ',cat:'–ö–æ—Ñ–µ',price:300,stock:38,desc:'–ö–æ—Ñ–µ —Å —à–æ–∫–æ–ª–∞–¥–æ–º',emoji:'üç´'},
      {id:genId(),name:'–†–∞—Ñ –∫–æ—Ñ–µ',cat:'–ö–æ—Ñ–µ',price:320,stock:45,desc:'–°–æ —Å–ª–∏–≤–∫–∞–º–∏ –∏ –≤–∞–Ω–∏–ª—å—é',emoji:'üßÅ'},
      {id:genId(),name:'–ê–π—Å-–∫–æ—Ñ–µ',cat:'–ö–æ—Ñ–µ',price:270,stock:60,desc:'–•–æ–ª–æ–¥–Ω—ã–π —Å–æ –ª—å–¥–æ–º',emoji:'üßä'},
      {id:genId(),name:'–ó–µ–ª—ë–Ω—ã–π —á–∞–π',cat:'–ß–∞–π',price:180,stock:90,desc:'–Ø–ø–æ–Ω—Å–∫–∏–π —Å–µ–Ω—á–∞',emoji:'üçµ'},
      {id:genId(),name:'–ò–≤–∞–Ω-—á–∞–π',cat:'–ß–∞–π',price:200,stock:55,desc:'–° —è–≥–æ–¥–∞–º–∏',emoji:'üåø'},
      {id:genId(),name:'–ú–∞—Ç—á–∞-–ª–∞—Ç—Ç–µ',cat:'–ß–∞–π',price:300,stock:35,desc:'–Ø–ø–æ–Ω—Å–∫–∏–π –º–∞—Ç—á–∞ —Å –º–æ–ª–æ–∫–æ–º',emoji:'üçÉ'},
      {id:genId(),name:'–ß–∏–∑–∫–µ–π–∫',cat:'–î–µ—Å–µ—Ä—Ç—ã',price:350,stock:18,desc:'–ù—å—é-–ô–æ—Ä–∫—Å–∫–∏–π',emoji:'üç∞'},
      {id:genId(),name:'–¢–∏—Ä–∞–º–∏—Å—É',cat:'–î–µ—Å–µ—Ä—Ç—ã',price:380,stock:12,desc:'–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π',emoji:'üçÆ'},
      {id:genId(),name:'–ö—Ä—É–∞—Å—Å–∞–Ω',cat:'–î–µ—Å–µ—Ä—Ç—ã',price:200,stock:30,desc:'–ú–∞—Å–ª—è–Ω–∏—Å—Ç—ã–π',emoji:'ü•ê'},
      {id:genId(),name:'–ú–∞—Ñ—Ñ–∏–Ω',cat:'–î–µ—Å–µ—Ä—Ç—ã',price:220,stock:25,desc:'–®–æ–∫–æ–ª–∞–¥–Ω—ã–π',emoji:'üßÅ'},
      {id:genId(),name:'–ê–≤–æ–∫–∞–¥–æ-—Ç–æ—Å—Ç',cat:'–ó–∞–≤—Ç—Ä–∞–∫–∏',price:420,stock:8,desc:'–° —è–π—Ü–æ–º –ø–∞—à–æ—Ç',emoji:'ü•ë'},
      {id:genId(),name:'–°—ã—Ä–Ω–∏–∫–∏',cat:'–ó–∞–≤—Ç—Ä–∞–∫–∏',price:350,stock:15,desc:'–°–æ —Å–º–µ—Ç–∞–Ω–æ–π',emoji:'ü•û'},
      {id:genId(),name:'–ë–æ—É–ª —Å –∞—Å–∞–∏',cat:'–ó–∞–≤—Ç—Ä–∞–∫–∏',price:450,stock:20,desc:'–ì—Ä–∞–Ω–æ–ª–∞ –∏ —Ñ—Ä—É–∫—Ç—ã',emoji:'ü´ê'},
      {id:genId(),name:'–Ø–π—Ü–∞ –ë–µ–Ω–µ–¥–∏–∫—Ç',cat:'–ó–∞–≤—Ç—Ä–∞–∫–∏',price:480,stock:10,desc:'–° –≥–æ–ª–ª–∞–Ω–¥—Å–∫–∏–º —Å–æ—É—Å–æ–º',emoji:'üç≥'},
      {id:genId(),name:'–ú–æ–ª–æ–∫–æ 3.2%',cat:'–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã',price:80,stock:200,desc:'1 –ª–∏—Ç—Ä',emoji:'ü•õ'},
      {id:genId(),name:'–ö–æ—Ñ–µ –∑—ë—Ä–Ω–∞ 1–∫–≥',cat:'–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã',price:1200,stock:5,desc:'–ê—Ä–∞–±–∏–∫–∞',emoji:'‚òï'},
      {id:genId(),name:'–°—Ç–∞–∫–∞–Ω 300–º–ª',cat:'–£–ø–∞–∫–æ–≤–∫–∞',price:8,stock:500,desc:'–ë—É–º–∞–∂–Ω—ã–π',emoji:'ü•§'}
    ];
    setData('products', products);
  }
  if (!getData('sales',null)||getData('sales',[]).length===0) {
    var prods=getData('products',[]);var sales=[];
    for(var i=0;i<15;i++){var p=prods[Math.floor(Math.random()*Math.min(10,prods.length))];if(!p)continue;
    var qty=Math.floor(Math.random()*4)+1;var d=new Date();d.setDate(d.getDate()-Math.floor(Math.random()*10));
    sales.push({id:genId(),product:p.name,qty:qty,price:p.price,total:p.price*qty,
    payment:['–ù–∞–ª–∏—á–Ω—ã–µ','–ö–∞—Ä—Ç–∞','Apple/Google Pay','–°–ë–ü'][Math.floor(Math.random()*4)],date:d.toISOString().split('T')[0]});}
    setData('sales',sales);
  }
  if(!getData('deliveries',null)||getData('deliveries',[]).length===0){
    setData('deliveries',[
      {id:genId(),date:today(),client:'–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞',phone:'+7 (999) 111-22-33',address:'—É–ª. –õ–µ–Ω–∏–Ω–∞, 15',items:'–ö–∞–ø—É—á–∏–Ω–æ x2, –ß–∏–∑–∫–µ–π–∫ x1',sum:850,status:'shipping',employee:'EMP-003',comment:''},
      {id:genId(),date:today(),client:'–î–º–∏—Ç—Ä–∏–π –ö–æ–∑–ª–æ–≤',phone:'+7 (999) 444-55-66',address:'–ø—Ä. –ú–∏—Ä–∞, 42',items:'–õ–∞—Ç—Ç–µ x3',sum:840,status:'assembling',employee:'EMP-001',comment:'–ü–æ–∑–≤–æ–Ω–∏—Ç—å'},
      {id:genId(),date:today(),client:'–ï–ª–µ–Ω–∞ –ü–æ–ø–æ–≤–∞',phone:'+7 (999) 777-88-99',address:'—É–ª. –ì–∞–≥–∞—Ä–∏–Ω–∞, 7',items:'–†–∞—Ñ x1',sum:320,status:'new',employee:'',comment:''}
    ]);
  }
  if(!getData('incoming',null)){setData('incoming',[]);}
}
initDemoData();

/* ================================================================
   NAVIGATION
   ================================================================ */
var currentPage='dashboard';
document.querySelectorAll('.nav-item').forEach(function(item){
  item.addEventListener('click',function(){
    var page=this.getAttribute('data-page');navigateTo(page);
    document.getElementById('sidebar').classList.remove('open');
    document.getElementById('sidebarOverlay').classList.remove('show');
  });
});
function navigateTo(page){
  currentPage=page;
  document.querySelectorAll('.nav-item').forEach(function(n){n.classList.remove('active')});
  document.querySelectorAll('.page').forEach(function(p){p.classList.remove('active')});
  document.querySelector('.nav-item[data-page="'+page+'"]').classList.add('active');
  document.getElementById('page-'+page).classList.add('active');
  refreshPage(page);
}
document.querySelectorAll('.tab').forEach(function(tab){
  tab.addEventListener('click',function(){
    var tabId=this.getAttribute('data-tab');var parent=this.closest('.page');
    parent.querySelectorAll('.tab').forEach(function(t){t.classList.remove('active')});
    parent.querySelectorAll('.tab-content').forEach(function(c){c.classList.remove('active')});
    this.classList.add('active');document.getElementById('tab-'+tabId).classList.add('active');
  });
});
document.getElementById('burgerBtn').addEventListener('click',function(){
  document.getElementById('sidebar').classList.add('open');
  document.getElementById('sidebarOverlay').classList.add('show');
});
document.getElementById('sidebarOverlay').addEventListener('click',function(){
  document.getElementById('sidebar').classList.remove('open');this.classList.remove('show');
});

/* ================================================================
   TOAST & MODAL
   ================================================================ */
function showToast(msg,type){var t=document.getElementById('toast');t.textContent=msg;t.className='toast '+(type||'success');t.classList.add('show');setTimeout(function(){t.classList.remove('show')},3000)}
function openModal(id){document.getElementById(id).classList.add('open')}
function closeModal(id){document.getElementById(id).classList.remove('open')}
document.querySelectorAll('.modal-overlay').forEach(function(o){o.addEventListener('click',function(e){if(e.target===this)this.classList.remove('open')})});

/* ================================================================
   PRODUCTS
   ================================================================ */
function getProducts(){return getData('products',[])}
function setProducts(arr){setData('products',arr)}
function renderProducts(){
  var products=getProducts();var search=document.getElementById('prodSearch').value.toLowerCase();var catF=document.getElementById('prodCatFilter').value;
  var filtered=products.filter(function(p){if(catF&&p.cat!==catF)return false;if(search&&p.name.toLowerCase().indexOf(search)===-1&&p.cat.toLowerCase().indexOf(search)===-1)return false;return true});
  document.getElementById('productsCount').textContent=filtered.length;
  var tbody=document.getElementById('productsBody');
  if(!filtered.length){tbody.innerHTML='<tr><td colspan="7" class="table-empty">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</td></tr>';return}
  tbody.innerHTML=filtered.map(function(p){var ss=p.stock<=0?'<span class="status red">–ù–µ—Ç</span>':p.stock<10?'<span class="status yellow">–ú–∞–ª–æ ('+p.stock+')</span>':'<span class="status green">–í –Ω–∞–ª–∏—á–∏–∏</span>';return '<tr><td class="text-muted" style="font-size:11px">'+p.id+'</td><td><strong>'+(p.emoji||'')+' '+p.name+'</strong>'+(p.desc?'<br><span class="text-muted" style="font-size:11px">'+p.desc+'</span>':'')+'</td><td>'+p.cat+'</td><td class="text-bold">'+formatMoney(p.price)+'</td><td>'+p.stock+' —à—Ç</td><td>'+ss+'</td><td class="actions-cell"><button class="btn-icon" onclick="editProduct(\''+p.id+'\')" title="–†–µ–¥.">‚úèÔ∏è</button><button class="btn-icon danger" onclick="deleteProduct(\''+p.id+'\')" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button></td></tr>'}).join('');
}
document.getElementById('prodSearch').addEventListener('input',renderProducts);
document.getElementById('prodCatFilter').addEventListener('change',renderProducts);
function openProductModal(){document.getElementById('prodEditId').value='';document.getElementById('prodName').value='';document.getElementById('prodCat').value='–ö–æ—Ñ–µ';document.getElementById('prodPrice').value='';document.getElementById('prodStock').value='';document.getElementById('prodDesc').value='';document.getElementById('prodEmoji').value='';document.getElementById('productModalTitle').textContent='–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä';openModal('productModal')}
function editProduct(id){var p=getProducts().find(function(x){return x.id===id});if(!p)return;document.getElementById('prodEditId').value=p.id;document.getElementById('prodName').value=p.name;document.getElementById('prodCat').value=p.cat;document.getElementById('prodPrice').value=p.price;document.getElementById('prodStock').value=p.stock;document.getElementById('prodDesc').value=p.desc||'';document.getElementById('prodEmoji').value=p.emoji||'';document.getElementById('productModalTitle').textContent='–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å: '+p.name;openModal('productModal')}
function saveProduct(){var name=document.getElementById('prodName').value.trim();var cat=document.getElementById('prodCat').value;var price=Number(document.getElementById('prodPrice').value);var stock=Number(document.getElementById('prodStock').value)||0;var desc=document.getElementById('prodDesc').value.trim();var emoji=document.getElementById('prodEmoji').value.trim();var editId=document.getElementById('prodEditId').value;if(!name||!price){showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É','error');return}var products=getProducts();if(editId){products=products.map(function(p){if(p.id===editId)return{id:p.id,name:name,cat:cat,price:price,stock:stock,desc:desc,emoji:emoji};return p});showToast('‚úÖ –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª—ë–Ω')}else{products.push({id:genId(),name:name,cat:cat,price:price,stock:stock,desc:desc,emoji:emoji});showToast('‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω')}setProducts(products);closeModal('productModal');renderProducts()}
function deleteProduct(id){if(!confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?'))return;setProducts(getProducts().filter(function(p){return p.id!==id}));showToast('üóëÔ∏è –£–¥–∞–ª—ë–Ω');renderProducts()}
function exportProducts(){downloadJSON('products_'+today()+'.json',getProducts());showToast('üìã –≠–∫—Å–ø–æ—Ä—Ç')}

/* ================================================================
   INCOMING
   ================================================================ */
function getIncoming(){return getData('incoming',[])}
function setIncoming(arr){setData('incoming',arr)}
function renderIncoming(){var list=getIncoming();var tbody=document.getElementById('incomingBody');if(!list.length){tbody.innerHTML='<tr><td colspan="5" class="table-empty">–ù–µ—Ç –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π</td></tr>';return}tbody.innerHTML=list.map(function(i){return '<tr><td>'+formatDate(i.date)+'</td><td><strong>'+i.product+'</strong></td><td class="text-bold">+'+i.qty+' —à—Ç</td><td>'+(i.supplier||'‚Äî')+'</td><td class="text-muted">'+(i.note||'‚Äî')+'</td></tr>'}).join('')}
function openIncomingModal(){var products=getProducts();var sel=document.getElementById('incProduct');sel.innerHTML=products.map(function(p){return '<option>'+(p.emoji||'')+' '+p.name+'</option>'}).join('');document.getElementById('incQty').value='';document.getElementById('incDate').value=today();document.getElementById('incSupplier').value='';document.getElementById('incNote').value='';openModal('incomingModal')}
function saveIncoming(){var rawVal=document.getElementById('incProduct').value;var qty=Number(document.getElementById('incQty').value);var date=document.getElementById('incDate').value||today();var supplier=document.getElementById('incSupplier').value.trim();var note=document.getElementById('incNote').value.trim();if(!qty||qty<=0){showToast('–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª-–≤–æ','error');return}var incoming=getIncoming();incoming.unshift({id:genId(),date:date,product:rawVal,qty:qty,supplier:supplier,note:note});setIncoming(incoming);var products=getProducts();products=products.map(function(p){if(rawVal.indexOf(p.name)!==-1){p.stock=(p.stock||0)+qty}return p});setProducts(products);closeModal('incomingModal');showToast('üì• +'+qty+' —à—Ç');renderProducts();renderIncoming()}

/* ================================================================
   SALES
   ================================================================ */
function getSales(){return getData('sales',[])}
function setSales(arr){setData('sales',arr)}
function renderSales(){var sales=getSales();var search=document.getElementById('salesSearch').value.toLowerCase();var df=document.getElementById('salesDateFrom').value;var dt=document.getElementById('salesDateTo').value;var filtered=sales.filter(function(s){if(search&&s.product.toLowerCase().indexOf(search)===-1&&s.id.toLowerCase().indexOf(search)===-1)return false;if(df&&s.date<df)return false;if(dt&&s.date>dt)return false;return true});document.getElementById('salesCount').textContent=filtered.length;var rev=filtered.reduce(function(a,s){return a+s.total},0);var avg=filtered.length?Math.round(rev/filtered.length):0;document.getElementById('salesStats').innerHTML=statCard('üí∞','amber',formatMoney(rev),'–í—ã—Ä—É—á–∫–∞')+statCard('üì¶','blue',filtered.reduce(function(a,s){return a+s.qty},0),'–ü—Ä–æ–¥–∞–Ω–æ')+statCard('üßæ','green',filtered.length,'–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π')+statCard('üìä','purple',formatMoney(avg),'–°—Ä–µ–¥–Ω–∏–π —á–µ–∫');var tbody=document.getElementById('salesBody');if(!filtered.length){tbody.innerHTML='<tr><td colspan="8" class="table-empty">–ù–µ—Ç –ø—Ä–æ–¥–∞–∂</td></tr>';return}tbody.innerHTML=filtered.map(function(s){return '<tr><td class="text-muted" style="font-size:11px">'+s.id+'</td><td>'+formatDate(s.date)+'</td><td><strong>'+s.product+'</strong></td><td>'+s.qty+'</td><td>'+formatMoney(s.price)+'</td><td class="text-bold text-accent">'+formatMoney(s.total)+'</td><td><span class="status gray">'+s.payment+'</span></td><td><button class="btn-icon danger" onclick="deleteSale(\''+s.id+'\')">üóëÔ∏è</button></td></tr>'}).join('')}
document.getElementById('salesSearch').addEventListener('input',renderSales);document.getElementById('salesDateFrom').addEventListener('change',renderSales);document.getElementById('salesDateTo').addEventListener('change',renderSales);
function openSaleModal(){var products=getProducts();var sel=document.getElementById('saleProduct');sel.innerHTML=products.map(function(p){return '<option value="'+p.id+'" data-price="'+p.price+'">'+(p.emoji||'')+' '+p.name+' ‚Äî '+p.price+'‚ÇΩ (–æ—Å—Ç: '+p.stock+')</option>'}).join('');document.getElementById('saleQty').value=1;document.getElementById('saleDate').value=today();document.getElementById('salePayment').value='–ö–∞—Ä—Ç–∞';updateSalePrice();openModal('saleModal')}
function updateSalePrice(){var sel=document.getElementById('saleProduct');var opt=sel.options[sel.selectedIndex];if(opt)document.getElementById('salePrice').value=opt.getAttribute('data-price');updateSaleTotal()}
function updateSaleTotal(){var q=Number(document.getElementById('saleQty').value)||0;var p=Number(document.getElementById('salePrice').value)||0;document.getElementById('saleTotalDisplay').textContent=formatMoney(q*p)}
function saveSale(){var sel=document.getElementById('saleProduct');var opt=sel.options[sel.selectedIndex];if(!opt){showToast('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä','error');return}var pid=sel.value;var pname=opt.textContent.split(' ‚Äî ')[0].trim();var qty=Number(document.getElementById('saleQty').value);var price=Number(document.getElementById('salePrice').value);var payment=document.getElementById('salePayment').value;var date=document.getElementById('saleDate').value||today();if(!qty||qty<=0||!price){showToast('–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª-–≤–æ –∏ —Ü–µ–Ω—É','error');return}var products=getProducts();var prod=products.find(function(p){return p.id===pid});if(prod&&prod.stock<qty){showToast('‚ö†Ô∏è –û—Å—Ç–∞—Ç–æ–∫: '+prod.stock,'error');return}if(prod){products=products.map(function(p){if(p.id===pid)p.stock=Math.max(0,p.stock-qty);return p});setProducts(products)}var sales=getSales();sales.unshift({id:genId(),date:date,product:pname,qty:qty,price:price,total:price*qty,payment:payment});setSales(sales);closeModal('saleModal');showToast('üí∞ '+formatMoney(price*qty));renderSales();renderProducts()}
function deleteSale(id){if(!confirm('–£–¥–∞–ª–∏—Ç—å?'))return;setSales(getSales().filter(function(s){return s.id!==id}));showToast('üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ');renderSales()}
function exportSales(){downloadJSON('sales_'+today()+'.json',getSales());showToast('üìã –≠–∫—Å–ø–æ—Ä—Ç')}

/* ================================================================
   DELIVERY
   ================================================================ */
function getDeliveries(){return getData('deliveries',[])}
function setDeliveries(arr){setData('deliveries',arr)}
var STATUSES={'new':{label:'–ù–æ–≤—ã–π',cls:'blue',emoji:'üÜï'},'assembling':{label:'–°–±–æ—Ä–∫–∞',cls:'yellow',emoji:'üì¶'},'shipping':{label:'–í –ø—É—Ç–∏',cls:'purple',emoji:'üöó'},'delivered':{label:'–î–æ—Å—Ç–∞–≤–ª–µ–Ω',cls:'green',emoji:'‚úÖ'},'cancelled':{label:'–û—Ç–º–µ–Ω—ë–Ω',cls:'red',emoji:'‚ùå'}};
var STATUS_ORDER=['new','assembling','shipping','delivered'];
function renderDeliveries(){var list=getDeliveries();var search=document.getElementById('deliverySearch').value.toLowerCase();var sf=document.getElementById('deliveryStatusFilter').value;var filtered=list.filter(function(d){if(sf&&d.status!==sf)return false;if(search){var h=(d.id+d.client+d.address+d.items+d.employee).toLowerCase();if(h.indexOf(search)===-1)return false}return true});document.getElementById('deliveryCount').textContent=filtered.length;var ac=list.filter(function(d){return d.status!=='delivered'&&d.status!=='cancelled'}).length;document.getElementById('deliveryBadge').textContent=ac||'';document.getElementById('deliveryStats').innerHTML=statCard('üÜï','blue',list.filter(function(d){return d.status==='new'}).length,'–ù–æ–≤—ã–µ')+statCard('üì¶','amber',list.filter(function(d){return d.status==='assembling'}).length,'–°–±–æ—Ä–∫–∞')+statCard('üöó','purple',list.filter(function(d){return d.status==='shipping'}).length,'–í –ø—É—Ç–∏')+statCard('‚úÖ','green',list.filter(function(d){return d.status==='delivered'}).length,'–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ');var tbody=document.getElementById('deliveryBody');if(!filtered.length){tbody.innerHTML='<tr><td colspan="8" class="table-empty">–ù–µ—Ç –¥–æ—Å—Ç–∞–≤–æ–∫</td></tr>';return}tbody.innerHTML=filtered.map(function(d){var st=STATUSES[d.status]||STATUSES['new'];var tl=renderTimeline(d.status);return '<tr><td class="text-muted" style="font-size:11px">'+d.id+'</td><td>'+formatDate(d.date)+'</td><td><strong>'+d.client+'</strong><br><span class="text-muted" style="font-size:11px">'+d.phone+'</span></td><td style="max-width:200px;font-size:12px">'+d.address+'<br><span class="text-muted" style="font-size:11px">'+d.items+'</span></td><td class="text-bold">'+formatMoney(d.sum)+'</td><td><span class="status '+st.cls+'">'+st.emoji+' '+st.label+'</span>'+tl+'</td><td>'+(d.employee||'<span class="text-muted">‚Äî</span>')+'</td><td class="actions-cell">'+(d.status!=='delivered'&&d.status!=='cancelled'?'<button class="btn-icon" onclick="advanceDelivery(\''+d.id+'\')" title="–î–∞–ª–µ–µ">‚è≠Ô∏è</button>':'')+'<button class="btn-icon" onclick="editDelivery(\''+d.id+'\')" title="–†–µ–¥.">‚úèÔ∏è</button><button class="btn-icon danger" onclick="deleteDelivery(\''+d.id+'\')" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button></td></tr>'}).join('')}
function renderTimeline(status){if(status==='cancelled')return '';var idx=STATUS_ORDER.indexOf(status);var h='<div class="timeline" style="margin-top:6px">';for(var i=0;i<STATUS_ORDER.length;i++){if(i>0)h+='<div class="timeline-line'+(i<=idx?' done':'')+'\"></div>';var c=i<idx?'done':(i===idx?'current':'');h+='<div class="timeline-dot '+c+'">'+(i<idx?'‚úì':(i+1))+'</div>'}h+='</div>';return h}
document.getElementById('deliverySearch').addEventListener('input',renderDeliveries);document.getElementById('deliveryStatusFilter').addEventListener('change',renderDeliveries);
function openDeliveryModal(){document.getElementById('delEditId').value='';document.getElementById('delClient').value='';document.getElementById('delPhone').value='';document.getElementById('delAddress').value='';document.getElementById('delItems').value='';document.getElementById('delSum').value='';document.getElementById('delEmployee').value='';document.getElementById('delStatus').value='new';document.getElementById('delDate').value=today();document.getElementById('delComment').value='';document.getElementById('deliveryModalTitle').textContent='üöó –ù–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞';openModal('deliveryModal')}
function editDelivery(id){var d=getDeliveries().find(function(x){return x.id===id});if(!d)return;document.getElementById('delEditId').value=d.id;document.getElementById('delClient').value=d.client;document.getElementById('delPhone').value=d.phone;document.getElementById('delAddress').value=d.address;document.getElementById('delItems').value=d.items;document.getElementById('delSum').value=d.sum;document.getElementById('delEmployee').value=d.employee||'';document.getElementById('delStatus').value=d.status;document.getElementById('delDate').value=d.date;document.getElementById('delComment').value=d.comment||'';document.getElementById('deliveryModalTitle').textContent='‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å';openModal('deliveryModal')}
function saveDelivery(){var client=document.getElementById('delClient').value.trim();var phone=document.getElementById('delPhone').value.trim();var address=document.getElementById('delAddress').value.trim();var items=document.getElementById('delItems').value.trim();var sum=Number(document.getElementById('delSum').value);var employee=document.getElementById('delEmployee').value.trim();var status=document.getElementById('delStatus').value;var date=document.getElementById('delDate').value||today();var comment=document.getElementById('delComment').value.trim();var editId=document.getElementById('delEditId').value;if(!client||!phone||!address||!items||!sum){showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è','error');return}var deliveries=getDeliveries();if(editId){deliveries=deliveries.map(function(d){if(d.id===editId)return{id:d.id,date:date,client:client,phone:phone,address:address,items:items,sum:sum,status:status,employee:employee,comment:comment};return d});showToast('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ')}else{deliveries.unshift({id:genId(),date:date,client:client,phone:phone,address:address,items:items,sum:sum,status:status,employee:employee,comment:comment});showToast('‚úÖ –°–æ–∑–¥–∞–Ω–æ')}setDeliveries(deliveries);closeModal('deliveryModal');renderDeliveries()}
function advanceDelivery(id){var dl=getDeliveries();dl=dl.map(function(d){if(d.id===id){var i=STATUS_ORDER.indexOf(d.status);if(i<STATUS_ORDER.length-1)d.status=STATUS_ORDER[i+1]}return d});setDeliveries(dl);showToast('‚è≠Ô∏è –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—ë–Ω');renderDeliveries()}
function deleteDelivery(id){if(!confirm('–£–¥–∞–ª–∏—Ç—å?'))return;setDeliveries(getDeliveries().filter(function(d){return d.id!==id}));showToast('üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ');renderDeliveries()}
function exportDeliveries(){downloadJSON('deliveries_'+today()+'.json',getDeliveries());showToast('üìã –≠–∫—Å–ø–æ—Ä—Ç')}

/* ================================================================
   DASHBOARD
   ================================================================ */
function renderDashboard(){var products=getProducts();var sales=getSales();var deliveries=getDeliveries();var rev=sales.reduce(function(a,s){return a+s.total},0);var ac=deliveries.filter(function(d){return d.status!=='delivered'&&d.status!=='cancelled'}).length;document.getElementById('dashStats').innerHTML=statCard('üí∞','amber',formatMoney(rev),'–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞','+12%','up')+statCard('üì¶','blue',products.length,'–¢–æ–≤–∞—Ä–æ–≤','','')+statCard('üßæ','green',sales.length,'–ü—Ä–æ–¥–∞–∂','+8%','up')+statCard('üöó','purple',ac,'–ê–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ—Å—Ç–∞–≤–æ–∫','','');var t1=document.getElementById('dashSalesBody');var rs=sales.slice(0,5);t1.innerHTML=rs.length?rs.map(function(s){return '<tr><td>'+s.product+'</td><td>'+s.qty+'</td><td class="text-bold text-accent">'+formatMoney(s.total)+'</td><td>'+formatDate(s.date)+'</td></tr>'}).join(''):'<tr><td colspan="4" class="table-empty">–ù–µ—Ç –ø—Ä–æ–¥–∞–∂</td></tr>';var t2=document.getElementById('dashDeliveryBody');var ad=deliveries.filter(function(d){return d.status!=='delivered'&&d.status!=='cancelled'}).slice(0,5);t2.innerHTML=ad.length?ad.map(function(d){var st=STATUSES[d.status];return '<tr><td class="text-muted" style="font-size:11px">'+d.id+'</td><td>'+d.client+'</td><td><span class="status '+st.cls+'">'+st.emoji+' '+st.label+'</span></td><td>'+(d.employee||'‚Äî')+'</td></tr>'}).join(''):'<tr><td colspan="4" class="table-empty">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö</td></tr>';var t3=document.getElementById('dashLowStockBody');var ls=products.filter(function(p){return p.stock<10}).sort(function(a,b){return a.stock-b.stock});t3.innerHTML=ls.length?ls.map(function(p){var c=p.stock===0?'red':'yellow';return '<tr><td><strong>'+(p.emoji||'')+' '+p.name+'</strong></td><td>'+p.cat+'</td><td><span class="status '+c+'">'+p.stock+' —à—Ç</span></td><td>'+formatMoney(p.price)+'</td></tr>'}).join(''):'<tr><td colspan="4" class="table-empty">–í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ üëç</td></tr>'}
function statCard(emoji,color,value,label,change,dir){return '<div class="stat-card"><div class="top"><div class="icon '+color+'">'+emoji+'</div>'+(change?'<span class="change '+dir+'">'+change+'</span>':'')+'</div><h3>'+value+'</h3><div class="label">'+label+'</div></div>'}

/* ================================================================
   SETTINGS AI
   ================================================================ */
function loadAIConfig(){var c=getData('ai_config',{});document.getElementById('cfgEnabled').value=c.enabled?'true':'false';document.getElementById('cfgUrl').value=c.apiUrl||'https://openrouter.ai/api/v1/chat/completions';document.getElementById('cfgModel').value=c.model||'z-ai/glm-4.5-air:free';document.getElementById('cfgKey').value=c.apiKey||'';document.getElementById('cfgTokens').value=c.maxTokens||300}
function saveAIConfig(){setData('ai_config',{enabled:document.getElementById('cfgEnabled').value==='true',apiUrl:document.getElementById('cfgUrl').value.trim(),model:document.getElementById('cfgModel').value.trim(),apiKey:document.getElementById('cfgKey').value.trim(),maxTokens:Number(document.getElementById('cfgTokens').value)||300});showToast('üíæ AI —Å–æ—Ö—Ä–∞–Ω—ë–Ω')}
async function testAI(){var r=document.getElementById('aiTestResult');r.style.display='block';r.textContent='‚è≥ –¢–µ—Å—Ç...';r.style.background='var(--warning-bg)';var cfg={apiUrl:document.getElementById('cfgUrl').value.trim(),model:document.getElementById('cfgModel').value.trim(),apiKey:document.getElementById('cfgKey').value.trim()};if(!cfg.apiKey){r.textContent='‚ùå –í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á';r.style.background='var(--danger-bg)';return}try{var res=await fetch(cfg.apiUrl,{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+cfg.apiKey},body:JSON.stringify({model:cfg.model,messages:[{role:'system',content:'–û—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º.'},{role:'user',content:'–ü—Ä–∏–≤–µ—Ç!'}],max_tokens:100})});if(!res.ok)throw new Error('HTTP '+res.status);var data=await res.json();r.textContent='‚úÖ '+data.choices[0].message.content;r.style.background='var(--success-bg)'}catch(e){r.textContent='‚ùå '+e.message;r.style.background='var(--danger-bg)'}}

/* ================================================================
   EXPORT / IMPORT
   ================================================================ */
function downloadJSON(f,d){var b=new Blob([JSON.stringify(d,null,2)],{type:'application/json'});var a=document.createElement('a');a.href=URL.createObjectURL(b);a.download=f;a.click();URL.revokeObjectURL(a.href)}
function exportAllData(){downloadJSON('brew_bean_backup_'+today()+'.json',{products:getProducts(),sales:getSales(),deliveries:getDeliveries(),incoming:getIncoming(),ai_config:getData('ai_config',{})});showToast('üì• –≠–∫—Å–ø–æ—Ä—Ç')}
function importAllData(event){var file=event.target.files[0];if(!file)return;var reader=new FileReader();reader.onload=function(e){try{var d=JSON.parse(e.target.result);if(d.products)setData('products',d.products);if(d.sales)setData('sales',d.sales);if(d.deliveries)setData('deliveries',d.deliveries);if(d.incoming)setData('incoming',d.incoming);if(d.ai_config)setData('ai_config',d.ai_config);showToast('üì§ –ò–º–ø–æ—Ä—Ç');refreshPage(currentPage)}catch(err){showToast('‚ùå –û—à–∏–±–∫–∞','error')}};reader.readAsText(file);event.target.value=''}
function clearAllData(){if(!confirm('–£–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ?'))return;if(!confirm('–¢–û–ß–ù–û?'))return;['products','sales','deliveries','incoming','initialized'].forEach(function(k){localStorage.removeItem('bb_'+k)});showToast('üóëÔ∏è –û—á–∏—â–µ–Ω–æ');initDemoData();refreshPage(currentPage)}

/* ================================================================
   REFRESH
   ================================================================ */
function refreshPage(page){
  switch(page){
    case 'dashboard':renderDashboard();break;
    case 'products':renderProducts();renderIncoming();break;
    case 'sales':renderSales();break;
    case 'delivery':renderDeliveries();break;
    case 'appearance':renderPresets();syncAllControls();updatePresetCards();break;
    case 'settings':loadAIConfig();break;
  }
}

// Init
loadSavedTheme();
renderPresets();
refreshPage('dashboard');
</script>
</body>
</html>
